# 📚 网络安全知识点汇总

## 💡 安全面试题总结流程（自用）

1. 确定问题，归类。
2. 先全部生成答案，筛选出挑最重要的几条。
3. 把剩下的每一项答案简化了，作为面试回答。
4. 对于今天要整理的问题，快速过一遍，不懂的问题立马问豆包：以上内容如何理解？请用通俗易懂的语言解释并举出实例。先不看解析。
5. 先把要整理的简单的问题整理好。
6. 再集中攻克难的问题。
7. 前5步都可以听着轻音乐去做。

---

## 💻 应用安全面试题

### 1. ★★★☆☆ 如何理解安全左移？

**理解记忆口诀：** 记住这三个阶段：设计，编码，部署。这是软件生命周期的核心阶段。

- **设计阶段：** 明确安全需求（如加密、权限）。
- **编码阶段：** 通过工具和培训防控漏洞。
- **部署阶段：** 快速扫描镜像与配置，并集成到CI/CD实现持续验证。

**面试回答：**

安全左移就是把安全工作提前到软件开发的早期阶段，从“出问题再解决”到“提前防控风险”。核心是“设计明需，编码防漏，构建扫描。”

---

### 2. ★★★☆☆ 如何系统地制定漏洞相关指标？

**理解记忆口诀：** “定选收设监”。

1. **定（定问题与范围）：** 明确安全目标（如提升系统安全）及覆盖范围（如系统、网络）；
2. **选（选核心指标）：** 根据目标选择关键指标（如漏洞密度、平均修复时间（MTTR））；
3. **收（收数据并验证）：** 用工具采集漏洞数据并验证准确性；
4. **设（设基线目标）：** 参考行业标准（如CVSS）设定初始值和目标值；
5. **监（定期监控与调整）：** 跟踪指标变化，结合反馈优化指标定义。

**面试回答：**

根据口诀：“定选收设监”，并简单解释每个字所代表的含义。

---

### 3. ★★★☆☆ SDL和DevSecOps有何差异？

**理解记忆口诀：** SDL重流程，阶段全覆盖；DevSecOps重集成，安全自动化。

- **SDL（安全开发生命周期）：** 强调在**需求、设计、编码**等每个阶段嵌入安全任务，并通过固定流程规范推进（**重流程**），如威胁建模、安全测试。
- **DevSecOps：** 注重将安全能力与开发运维流程深度融合（**重集成**），通过CI/CD流水线中的**自动化工具**（如漏洞扫描）实现持续防护，并灵活响应变化（**安全自动化**）。

**面试回答：**

SDL重流程，阶段全覆盖（强调在需求、设计、编码阶段）；DevSecOps重集成（指深度融合），安全自动化（通过CI/CD流水线实现）。

---

### 4. ★★★☆☆ 抽象来看， 安全评估到底要评什么东西？

**理解记忆口诀：** 识资产，评威胁，查漏洞，验防护，对合规

1. **识资产：** 明确需要保护的核心数据和系统；
2. **评威胁：** 分析可能的攻击者、攻击手段和路径；
3. **查漏洞：** 通过扫描或测试发现系统中的安全缺陷；
4. **验防护：** 检查防火墙、加密等安全措施是否有效；
5. **对合规：** 对照法律法规和标准评估是否达标，并提出改进措施。

**面试回答：**

按照识资产，评威胁，查漏洞，验防护，对合规的口诀回答，并简单解释每个口诀所代表的含义。

---

### 5. ★★★☆☆ 新应用如何评估安全风险？

**理解记忆口诀：** 识资产，评威胁，查漏洞，验防护，对合规 + **查代码，管权限**

在通用评估基础上增加：

1. **查代码：** 对应用程序的源代码进行全面检查，查找可能存在的漏洞或不安全的编码实践。
2. **管权限：** 定义并实施严格的权限管理规则，确保只有授权用户才能访问特定资源和服务。

**面试回答：**

从口诀“识资产，评威胁，查漏洞，验防护，对合规 + 查代码，管权限”分条展开论述。

---

### 6. ★★★☆☆ 需求阶段、系统分析阶段安全评估的侧重点是什么？

**理解记忆：**

- **需求阶段：** 识资产，评威胁，对合规
- **系统分析阶段：** 查漏洞，验防护，**审架构**

**面试回答：**

- **需求阶段：** 识资产，评威胁，对合规（侧重于宏观风险与制度规范）。
- **系统分析阶段：** 查漏洞，验防护，审架构（侧重于技术细节和设计缺陷）。

---

### 7. ★★★☆☆ 算法模型的安全风险如何评估？

**理解记忆：** 数据安全、模型攻击、隐私保护、算法偏见、应急合规。

1. **数据安全：** 评估训练数据合法性、脱敏技术及访问控制。
2. **模型攻击：** 通过对抗样本测试、压力测试评估模型抗攻击能力，防范参数泄露和数据投毒。
3. **隐私保护：** 评估差分隐私等技术，遵循最小必要原则。
4. **算法偏见：** 评估特征重要性识别算法偏见。
5. **应急合规：** 评估应急预案，验证跨境合规性。

**面试回答：**

从数据安全、模型攻击、隐私保护、算法偏见、应急合规五个方面进行阐述。

---

## 🛡️ 安全运营

### 8. ★★★☆☆ 从网络安全层面来讲金融业务有何特色？

**理解记忆口诀：** 攻击、数据、业务、合规。

1. **攻击：** 针对钓鱼攻击、勒索软件等威胁，部署威胁情报和入侵检测技术。
2. **数据：** 金融数据敏感，需通过加密、脱敏等技术保护用户身份证号、银行卡信息，防止泄露或篡改。
3. **业务：** 核心交易需实时处理，依赖灾备系统和冗余架构，确保业务连续性。
4. **合规：** 严格遵守《网络安全法》《个人信息保护法》等法规，通过合规审计和等保测评规避法律风险。

**面试回答：**

从攻击、数据、业务、合规的角度理解回答。

---

### 9. ★★★☆☆ 如何判断评估覆盖范围的优先级？

**理解记忆口诀：** 业务、数据、网络、历史、第三方。

1. **业务重要性：** 优先评估支撑核心业务功能的系统，如支付、用户认证。
2. **数据的敏感程度：** 对涉及个人身份信息（PII）、金融数据等敏感信息的系统提高评估优先级。
3. **网络暴露情况：** 优先覆盖暴露在公网的系统，如Web应用、API接口。
4. **历史安全表现：** 对曾发生过安全事件、存在较多历史漏洞的系统优先评估。
5. **第三方依赖程度：** 对依赖外部组件、开源库或第三方服务较多的系统加强评估。

**面试回答：**

从业务、数据、网络、历史、第三方的角度回答。

---

### 10. ★★★☆☆ 如何系统提高安全评估效率？如何降低个人检验导致评估不一致？

**理解记忆口诀：** 自动化工具、标准化流程。

- **自动化工具：** 使用漏洞扫描器（如Nessus）、渗透测试平台（如Burp Suite）和自动化报告生成工具完成基线检查、漏洞识别和报告输出。
- **标准化流程：** 制定统一的评估检查清单（Checklist）、报告模板和整改指南，确保不同团队和项目遵循相同标准，降低因流程差异导致的重复验证和返工。

**面试回答：**

从自动化工具、标准化流程出发，简答阐述一下。

---

### 11. ★★★☆☆ 互联网应用和办公后台应用的风险区别有哪些？

**理解记忆口诀：** 用户访问安全（外防攻击内防越权），数据安全（外重隐私内重合规），部署环境安全（外用WAF内用零信任）。

1. **用户访问安全：** 互联网应用易受DDoS、XSS等外部攻击；办公后台多集中在非法越权访问、凭证泄露等内部安全问题。
2. **数据安全：** 互联网应用涉及大量用户个人信息，需严格遵守《个人信息保护法》；办公后台应用处理企业内部数据，需满足《网络安全法》《等保2.0》。
3. **部署环境安全：** 互联网应用防护重点包括Web应用防火墙（WAF）和API安全；办公后台应用需通过零信任架构和最小权限原则限制内部访问风险。

**面试回答：**

根据口诀回答，并对口诀的每条内容简单介绍。

---

### 12. ★★★☆☆ 密码如何加密保存？

**理解记忆口诀：** 加盐哈希，存算分离，验时重算

- **加盐哈希：** 密码存储时要生成随机盐值并与密码拼接，使用 bcrypt、Argon2 等强哈希算法进行单向计算。
- **存算分离：** 数据库只保存哈希值与对应的盐值，绝不存储明文密码。
- **验时重算：** 用户登录时，取出盐值与输入密码重新拼接并哈希，与存储的哈希值比对验证。

**面试回答：**

根据口诀加盐哈希，存算分离，验时重算，叙述整个完整的过程。

---

### 13. ★★★☆☆ 某些场景（登录、注册、修改密码、支付）会存在哪些风险以及如何防范？

| 场景 | 风险 | 防范措施 |
| :--- | :--- | :--- |
| **登录** | 暴力破解、凭证填充、会话劫持。 | 账户锁定、多因素认证（MFA）、安全管理会话令牌（如HttpOnly）。 |
| **注册** | 恶意账号注册、撞库、信息滥用。 | 邮箱/手机验证码校验、限制注册频率、严格验证用户输入。 |
| **修改密码**| 未验证身份导致账户被劫持。 | 修改前强制进行身份验证（原密码、验证码），新密码满足复杂度。 |
| **支付** | 交易被篡改、未授权支付、敏感信息泄露。 | HTTPS加密传输、支付指令数字签名/一次性令牌（OTP）、关键操作二次验证。 |

**面试回答：**

分场景（登录、注册、修改密码、支付）列举风险并简述防范措施。

---

### 14. ★★★☆☆ 哪些方法可以防止爆破？

**理解记忆口诀：** 图形验证码、多因素认证（MFA）、账户锁定、登录频率限制、检测异常登录。

1. **使用图形验证码：** 在登录界面加入CAPTCHA，有效区分人类用户与自动化脚本。
2. **多因素认证（MFA）：** 即使密码被猜中，攻击者仍需第二重验证因素（如短信验证码）才能登录。
3. **账户锁定：** 当连续多次输入错误密码后，暂时锁定账户登录功能。
4. **登录频率限制：** 对同一IP或设备在单位时间内的登录请求次数进行限制。
5. **检测异常登录：** 通过分析登录时间、地点、设备等行为特征，识别可疑尝试并触发额外验证或告警。

**面试回答：**

图形验证码、多因素认证（MFA）、账户锁定、登录频率限制、检测异常登录。

---

### 15. ★★★☆☆ 接口B的参数是从接口A的响应中获取的，会存在什么风险？

**理解记忆口诀：** 数据完整性、未授权操作、易遭受攻击、信息泄露。

1. **数据完整性：** 接口A的响应若被篡改，接口B的请求可能包含错误或恶意信息。
2. **未授权操作：** 未经适当验证直接使用A的数据，可能导致在B处执行未经授权的操作。
3. **易遭受攻击：** 直接使用A的数据可能遭受SQL注入、跨站脚本（XSS）等攻击。
4. **信息泄露：** 接口A返回的数据中可能包含敏感信息，不妥善处理传递给B可能导致隐私泄露。

**面试回答：**

利用接口A的响应来构造接口B的请求，会存在数据完整性、未授权操作、易遭受攻击以及信息泄露的问题。（可对每个方面说一两句话）

---

### 16. ★★★☆☆ 如何看待未来安全评估的趋势？

**理解记忆口诀：** 智评全链、数据驱动、多层评估。

1. **智评全链：** 通过自动化工具（如SAST/DAST）和CI/CD实现安全评估智能化（智评），覆盖从开发到运维的全生命周期（全链）。
2. **数据驱动：** 利用AI分析海量数据，预测攻击行为，动态量化风险并辅助决策。
3. **多层评估：** 评估范围扩展至系统、第三方服务及供应链，引入多米诺效应分析等综合风险模型。

**面试回答：**

智评全链、数据驱动、多层评估。

---

### 17. ★★★★☆ 如何评估某个使用区块链/云原生/算法安全技术的业务安全性？

| 技术 | 侧重点（识资产，评威胁，验防护） |
| :--- | :--- |
| **区块链** | **识资产：** 智能合约代码、共识机制。 **评威胁：** 双花攻击、跨链通信风险、量子计算机攻击。 **验防护：** 加密算法强度。 |
| **云原生** | **识资产：** 容器、微服务、Kubernetes集群。 **评威胁：** DDoS攻击、容器逃逸。 **验防护：** 网络隔离（零信任架构）、访问控制（多因素认证）。 |
| **算法安全**| **评威胁：** 抗量子计算攻击能力、侧信道攻击（时序分析）、跨链数据泄露风险。 **验防护：** 验证加密算法强度。 |

**面试回答：**

每条从识资产，评威胁，验防护的角度回答一到两点。

---

### 18. ★★☆☆☆ 网络安全中如何规避弱口令带来的风险？

**理解记忆口诀：** 设置强密码和定期更换密码（个人角度）+ 图形验证码、多因素认证（MFA）、账户锁定、登录频率限制、检测异常登录（系统角度）。

**面试回答：**

1. 设置强密码
2. 定期更换密码
3. 图形验证码
4. 多因素认证（MFA）
5. 账户锁定
6. 登录频率限制
7. 检测异常登录

---

### 19. ★★★☆☆ 硬编码密钥有何风险以及如何解决？

**理解记忆：**

- **密钥泄露风险：** 硬编码的密钥可能被**逆向提取**（如通过反编译APK、IDA工具分析二进制文件），或因**代码仓库**（如GitHub）**误提交暴露**。
- **解决方案：** **加密存储**（如AES加密），运行时从**安全后端动态获取**密钥，避免明文存储和静态分析风险。

**面试回答：**

- **风险：** 逆向提取，代码仓库误提交暴露。
- **解决：** 加密存储，从安全后端动态获取密钥。

---

### 20. ★★★★☆ 什么是0day漏洞？0day漏洞如何防御？

**0day漏洞：** 指软件或系统中尚未被公开披露且无官方补丁的安全缺陷，攻击者可在此漏洞被厂商或公众知晓前直接利用其发起攻击。

**理解记忆口诀：** 补漏洞、防异常、隔区域

1. **补漏洞：** 及时关注漏洞库和厂商公告，快速更新补丁，减少系统暴露时间。
2. **防异常：** 部署IDS/IPS系统，实时监控网络流量，发现并阻断可疑行为。
3. **隔区域：** 用VLAN、DMZ隔离关键系统，限制访问权限，实行最小权限原则，防止横向渗透。

**面试回答：**

根据口诀：“补漏洞、防异常、隔区域”做简要回答。

---

### 21. ★★★☆☆ GitHub等三方泄漏敏感信息如何防御？

**理解记忆口诀：** 仓库要私有，推送先扫描，密钥不落地

1. **仓库要私有：** 使用私有仓库+权限控制，防止未授权访问。
2. **推送先扫描：** 部署推送保护（Push Protection）功能，提交时自动检测，拦截密钥等敏感信息。
3. **密钥不落地：** 密钥存专用服务（如Vault、AWS Secrets Manager），运行时动态获取，不进代码库。

**面试回答：**

根据仓库要私有，推送先扫描，密钥不落地，分条阐述。

---

### 22. ★★★★☆ 业务逻辑漏洞如何通过技术手段避免写出来？

**理解记忆口诀：** 设计防漏洞，输入严把关，权限服务端

1. **设计防漏洞：** 提前做威胁建模，规范业务流程（如强制校验订单状态、库存扣减顺序），堵住逻辑缺陷。
2. **输入严把关：** 后端校验所有参数（如价格、数量、用户ID），用白名单和状态记录防篡改，防止跳过关键步骤。
3. **权限服务端：** 权限判断放在服务端（基于角色的访问控制RBAC），不信任客户端传来的角色信息，关键操作加二次验证。

**面试回答：**

根据设计防漏洞，输入严把关，权限服务端分条回答。

---

### 23. ★★★★☆ 软件供应链后门和漏洞如何系统规避？

**理解记忆口诀：** SBOM，安全左移，持续监控

1. **SBOM：** 生成并维护软件物料清单（SBOM），记录软件的组件构成及依赖关系，做到供应链透明。
2. **安全左移：** 在开发早期（需求分析、设计）引入安全管控，从可信源获取组件，通过CI/CD集成漏洞扫描工具。
3. **持续监控：** 持续跟踪依赖漏洞，通过自动化工具（如GitHub Dependabot）自动预警和修复，响应快于攻击。

**面试回答：**

SBOM，安全左移，持续监控。

---

### 24. ★★★★☆ 为什么Session ID要和设备关联绑定？

**理解记忆口诀：** 一码一设备，异常可追踪

1. **一码一设备：** Session ID与设备绑定，防止被盗后在其他设备滥用（如通过XSS或中间人攻击窃取ID后在不同设备冒用身份）。
2. **异常可追踪：** 服务器记录设备信息，发现多端登录等异常行为可及时拦截处置（如发现同一Session ID在多个设备上活跃，可强制用户重新认证）。

**面试回答：**

一码一设备，异常可追踪。

---

### 25. ★★★★☆ 为什么要求小程序的Session ID不能在其他平台上使用？

**理解记忆口诀：** 防止会话劫持，避免业务漏洞

1. **防止会话劫持：** 避免被拿到其他平台冒用，绕过原平台的额外验证（如从小程序 Session ID 转移到 PC 端发起支付，绕过 PC 端的二次验证）。
2. **避免业务漏洞：** 防止利用规则差异绕过验证。例如：PC 端支付需输入验证码，而小程序端无需验证码。若 Session ID 跨平台可用，攻击者可将 PC 端的 Session ID 用于小程序端，绕过验证码校验。

**面试回答：**

防止会话劫持，避免业务漏洞。

---

### 26. ★★☆☆☆ 甲方渗透测试和乙方渗透测试有何差异？

**理解记忆口诀：** 甲守内乙对外，范围有深浅，合规要分清

1. **甲守内乙对外：** 甲方专注自身系统安全（保障业务），乙方为客户提供外部评估服务（服务交付）。
2. **范围有深浅：** 甲方懂业务逻辑，测试深入（如针对业务逻辑漏洞）；乙方视角广，覆盖全面（如针对第三方组件漏洞）。
3. **合规要分清：** 甲方遵循内部流程；乙方依客户授权和行业标准执行（如PCI DSS），责任边界明确。

**面试回答：**

甲守内乙对外，范围有深浅，合规要分清。

---

### 27. ★★★★☆ 哪些漏洞的测试对业务有损？如何避免？

**理解记忆口诀：** 命令执行-环境隔离+限制权限，数据库注入-参数预编+限制权限

1. **命令执行（如执行 rm -rf /）：**
    - **避免：** 必须在**独立测试环境或沙箱**中进行，**限制系统权限**（如关闭危险函数），禁止在生产环境直接验证危险操作。
2. **数据库注入（如执行 DELETE FROM users;）：**
    - **避免：** 针对数据库注入，必须使用**参数化查询或预编译语句**进行数据绑定，同时在测试中使用**只读权限账户**和虚拟数据库。

**面试回答：**

命令执行-环境隔离+限制权限，数据库注入-参数预编+限制权限（使用只读权限）。

---

### 28. ★★☆☆☆ Redis未授权访问漏洞有哪些利用方式？

**理解记忆口诀：** 写公钥，写定时任务，写WebShell文件。

1. **写入SSH公钥文件：** 通过 `CONFIG SET` 修改数据保存路径，将公钥写入目标服务器的 `~/.ssh/authorized_keys` 文件，实现免密登录（要求Redis以root权限运行）。
2. **利用定时任务反弹Shell：** 通过 `SET` 命令向 `/etc/crontab` 文件写入反弹Shell的定时任务，待任务触发后获取Shell权限（要求Redis以root权限运行）。
3. **写入WebShell文件：** 利用 `CONFIG SET` 将恶意PHP代码（如 `<?php @eval($_POST['cmd']);?>`）保存为网站目录下的可执行文件（如 `shell.php`），通过访问触发木马代码。

**面试回答：**

写公钥，写定时任务，写WebShell文件。

---

### 29. ★★★☆☆ SSRF利用方式及修复方案？

| 类别 | 利用方式 | 修复方案 |
| :--- | :--- | :--- |
| **利用** | 1. **攻击内网应用程序：** 结合Redis未授权访问实现RCE，或对内网Web服务发起HTTP请求触发漏洞。 2. **文件读取与协议扩展：** 通过 `file://` 协议读取服务器本地文件（如 `/etc/passwd`），或利用 `gopher://` 协议发送自定义TCP/IP数据包攻击内网服务。 | 1. **白名单机制与输入验证：** 采用**白名单**限制可访问的目标地址，避免使用黑名单，并对输入进行过滤，防止绕过检测。 2. **内网访问隔离：** 通过**网络层策略**（如安全组、防火墙规则）禁止应用服务器直接访问内网关键服务。 |

**面试回答：**

- **利用方式：** 攻击内网应用、文件读取与协议扩展（并举例）。
- **修复方案：** 白名单机制与输入验证、内网访问隔离。

---

### 30. ★★★☆☆ Java和PHP的SSRF区别？

| 语言 | 漏洞触发机制 | 防御侧重点 |
| :--- | :--- | :--- |
| **Java** | 强类型语言，漏洞多出自**第三方库或自定义HTTP客户端**中（如Apache HttpClient），需重点审查HTTP客户端代码。 | 需通过**白名单校验URL域名和IP段**（如禁止访问内网IP 192.168.x.x）。 |
| **PHP** | 弱类型语言，**运行时易受控**，漏洞多与图片加载、API调用或文件下载功能相关。 | 须在图片加载等功能中**过滤输入**，并通过 `curl_setopt` **禁用 `follow_location`** 防止30x重定向跳转内网资源。 |

**面试回答：**

Java编译严格，漏洞多出自第三方库，需重点审查HTTP客户端代码，通过白名单校验URL域名和IP段。PHP弱类型运行时易受控，须在图片加载等功能中过滤输入、禁用自动跳转。

---

### 31. ★★★☆☆ JSONP的业务意义，如何设计落地一个CSRF Token？

**JSONP的业务意义：**

- **突破同源策略限制：** 浏览器不允许不同网站直接互相请求数据（同源策略）。JSONP利用 `<script>` 标签能跨域加载数据的特点，绕开限制，实现从其他网站获取数据。

**如何设计落地一个CSRF Token：**

**理解记忆口诀：** 随机生成，身份绑定，安全防护

1. **随机生成：** 采用高安全性的随机算法生成Token（如32位以上字符串或UUID），确保不可预测。
2. **身份绑定：** 将生成的Token与当前登录用户绑定，存储在服务器的SESSION中，使每个Token仅对应特定用户。
3. **安全防护：** 通过HTTPS协议传输Token，不在前端页面源码中明文暴露Token，并限制Token的使用范围。

**面试回答：**

JSONP的业务意义是突破同源策略限制。CSRF Token设计落地关键三点：随机生成，身份绑定，安全防护（并简述每点）。

---

### 32. ★★☆☆☆ CORS原理、利用及修复？

**CORS原理：**

- 是一种浏览器跨域控制机制，通过服务器返回的特殊响应头（如 `Access-Control-Allow-Origin`）来决定是否允许网页向其他域名发请求。
- 复杂请求会先发一个 `OPTIONS` 预检请求“探路”，确认允许后才真正发送。

**CORS利用：**

- 攻击者可利用宽松的 `Access-Control-Allow-Origin` （如设置为`*`）或未校验Origin头等缺陷，窃取用户敏感数据（如用户名、邮箱）。

**CORS修复：**

1. **限制允许的源：** 将 `Access-Control-Allow-Origin` 设置为具体域名（如`https://example.com`），而非`*`，并校验请求头中的Origin值是否在白名单内。
2. **禁用凭证共享：** 不需要跨域携带Cookie等凭证时，将 `Access-Control-Allow-Credentials` 设置为`false`。

**面试回答：**

参考理解记忆的部分回答。

---

### 33. ★☆☆☆☆ CRLF注入原理？

**CRLF注入原理：**

若程序未过滤用户输入中的 CRLF（`\r\n`，即回车换行），并将其直接拼入响应头或日志，攻击者可注入 `\r\n`，导致接收方（如浏览器）误解析后续内容为**新的头或数据**，引发恶意跳转、Cookie 劫持等问题。

**面试回答：**

攻击者注入 `\r\n`，导致接收方误解析后续内容为新的头或数据，引发恶意跳转、Cookie 劫持等问题。（必要时举例说明，如在HTTP响应头注入 `\r\nSet-Cookie:admin=true`）

---

### 34. ★★☆☆☆ URL白名单如何绕过？

**理解记忆口诀：** 特殊字符注入、编码绕过、域名解析欺骗

1. **特殊字符注入：** 攻击者在URL中使用`@`、`|`、`%00`等干扰解析，如`http://evil.com@whitehost/path`，系统可能误判域名为`whitehost`，实际请求发往`evil.com`。
2. **编码绕过：** 攻击者使用URL编码（如`%2e`代替`.`）或双重编码（如`%252e`）绕过关键字检查，因系统未先解码再验证。
3. **域名解析欺骗：** 利用DNS重绑定、伪造子域名或短链接跳转至恶意目标，因系统只验表面，未查最终地址。

**面试回答：**

从特殊字符注入、编码绕过、域名解析欺骗分条举例回答。

---

### 35. ★★★★☆ Fastjson、Log4j常见漏洞原理？如何彻底解决该漏洞？

| 漏洞 | 原理 | 根本原因 | 彻底解决 |
| :--- | :--- | :--- | :--- |
| **Fastjson** | 攻击者利用 `@type` 功能指定一个危险的内置类（如 `JdbcRowSetImpl`），并让它从恶意服务器（如LDAP）加载代码，导致**远程代码执行**。 | Fastjson 太“信任”输入的类名，没有限制哪些类可以被加载。 | 1. **升级 Fastjson 到 1.2.83 或更高版本**（新版本默认关闭危险功能）。 2. **关闭 AutoType**（设置 `safeMode=true`）。 |
| **Log4j** | Log4j 会自动解析日志中的 `${}` 内容，攻击者利用 `${jndi:ldap://...}` 让服务器去下载并执行恶意代码，导致**远程代码执行**。 | Log4j 对用户输入的内容无条件执行了JNDI查找功能。 | 1. **升级 Log4j 到 2.16.0 或更高版本**（默认关闭JNDI查找）。 2. **启动参数加：`-Dlog4j2.formatMsgNoLookups=true`**（关闭所有 `${}` 解析）。 |

**面试回答：**

按照表格中的原理和解决办法回答。

---

### 36. ★★☆☆☆ 业务逻辑漏洞有哪些具体类型？

**理解记忆口诀：** 支付漏洞、权限越权、流程绕过。

1. **支付漏洞：** 攻击者修改订单金额、数量、运费等参数，导致损失。
2. **权限越权：** 系统权限检查不严，普通用户可访问他人数据（水平越权）或直接进入管理员页面（垂直越权）。
3. **流程绕过：** 攻击者跳过关键步骤，如未付款就直接访问“支付成功”页面。

**面试回答：**

以支付为例：支付漏洞、权限越权、流程绕过，并举出一些小例子。

---

### 37. ★★☆☆☆ 身份标识明文传输会导致什么风险？

**理解记忆口诀：** 中间人攻击（MITM）

- 攻击者通过监听网络流量截获**明文传输**的身份标识（如HTTP请求中的用户名、密码、API密钥），无需破解即可直接**冒充用户登录**。
- **实例：** 在未启用HTTPS的网站中，登录信息会被攻击者实时捕获；Nacos等微服务组件若未加密传输，凭证泄露后攻击者可访问、篡改配置。

**面试回答：**

中间人攻击，参考理解记忆的例子。

---

### 38. ★★☆☆☆ 水平越权触发点会存在哪些位置？

**水平越权触发点（本质是后端未校验“当前用户是否有权操作这个数据”）：**

1. **URL参数篡改：** 通过修改请求中的ID参数（如 `uid=123` 改为 `uid=456`）越权访问他人数据。
2. **API参数伪造：** 接口仅依赖前端传的 `user_id` 等参数，未绑定当前用户身份，攻击者可伪造请求修改或窃取他人数据。
3. **数据库查询缺权限条件：** SQL查询未关联当前用户，如缺少 `AND user_id=current_user_id`，导致通过修改ID即可越权查看他人数据。

**面试回答：**

URL参数篡改、API参数伪造、数据库查询缺权限条件，并简述每点。

---

### 39. ★★★☆☆ 水平越权有哪几种检测方式？

**理解记忆口诀：** 手动重放，自动扫描。

1. **手动重放：** 用抓包工具（如Burpsuite）截取请求，修改关键参数（如用户ID、资源ID）或身份凭证（Cookie/Token），重放请求，观察是否能访问他人数据。
2. **自动扫描：** 使用IDOR_detect_tool、AuthMatrix等工具，自动替换资源ID或Token信息，比对响应差异，识别越权行为。

**面试回答：**

手动重放，自动扫描。

---

### 40. ★★★★☆ 通过数字加减遍历或通过两个账号互测的方式进行水平越权测试有何优劣势？

| 方式 | 优势 | 劣势 |
| :--- | :--- | :--- |
| **账号互测** | 1. **更全面隐蔽：** 不依赖资源ID连续性，适用于所有资源类型，贴近真实攻击。 2. **更安全：** 不影响业务（仅在两个测试账号间操作）。 | 1. **复杂度高：** 需准备至少两个合法账号。 2. **效率略低：** 需同时调整多个参数。 |
| **数字加减遍历** | 1. **效率高：** 针对单个未校验的ID（如订单ID、文件ID）进行递增/递减测试，快速定位问题。 | 1. **覆盖不足：** 仅适用于资源ID是连续数字的场景，无法测试UUID等非连续ID。 2. **易被封禁：** 容易触发频率限制或异常行为检测。 |

**面试回答：**

账号互测全面隐蔽、更安全，但效率略低；数字加减遍历效率高，但覆盖不足、易被封禁。

---

### 41. ★★★★☆ 某个APP的某个功能按钮是灰色不可用状态，如何绕过其限制？

1. **抓包重放：** 用工具抓取APP发出的请求，分析灰色按钮对应的接口，直接修改参数并重发，绕过前端限制，看能否执行操作。
2. **换平台尝试：** 同一个功能在APP上禁用，可能在网页或电脑端没限制，可换个设备或浏览器试试能否操作。
3. **换身份操作：** 如果后端没做权限检查，可把高权限账号的登录凭证（如Token）复制到自己请求里，伪装成高权限用户去调用接口。

**面试回答：**

抓包重放、换平台尝试、换身份操作。

---

### 42. ★★★★☆ 流程绕过漏洞如何抽象理解归类？

**流程绕过漏洞本质：** 业务流程中权限、状态或规则校验不严，导致攻击者通过异常路径绕过限制。

1. **阶段校验不一致：** 创建、修改、删除等环节权限控制不统一，如创建需认证，删除却无验证。
2. **步骤间断层：** 前置验证通过后，后续操作未复用结果，导致敏感操作缺少校验。
3. **并发处理缺陷：** 未限制并行操作，可利用多请求实现重复提交或多次执行（如重复领券）。

**面试回答：**

流程绕过漏洞本质是业务流程中权限、状态或规则校验不严。举出一些例子：阶段校验不一致、步骤间断层、并发处理缺陷。

---

### 43. ★★★★★ 如何通过技术手段杜绝（不是缓解）水平越权漏洞？

1. **前后端双重校验：** 前端校验仅作提示，**后端必须独立验证**用户是否有权操作该数据，防止参数篡改。
2. **绑定用户身份标识：** 通过Token或Session关联用户身份，后端用此信息查数据归属，**不依赖用户提交的ID**。
3. **模糊资源ID：** 用UUID或加密ID替代自增数字，**防止枚举猜测**，后端需解密验证后再授权访问。
4. **严控输入参数：** 对所有参数校验，采用**白名单机制**，确保请求中的数据属于当前用户，非法值直接拒绝。

**面试回答：**

前后端双重校验、绑定用户身份标识、模糊资源ID、严控输入参数。

---

### 44. ★★★☆☆ 建设一个API网关，如何系统解决未授权访问、请求篡改、重放等风险？

**理解记忆口诀：** 认证鉴权、签名校验、防重放。

1. **防未授权访问（认证鉴权）：** 网关验证请求的凭证（如Token）有效性，并结合用户角色等权限规则，双重校验通过才放行。
2. **防请求篡改（签名校验）：** 请求需带签名（如HMAC-SHA256），网关按约定算法重新计算并比对，不一致则拒绝，确保数据完整性。
3. **防重放攻击（防重放）：** 请求需含**时间戳**和**随机数（Nonce）**，网关检查时间是否有效、随机数是否已使用，防止重复提交。

**面试回答：**

认证鉴权（Token、权限规则）、签名校验（签名）、防重放（时间戳和随机数）。

---

### 45. ★★★★☆ 设计API签名时，随机数使用秒时间戳（timestamp/s）会存在什么风险？

1. **易受重放攻击：** 攻击者可在秒级时间窗口内重复发送旧请求，服务端可能因时间戳未过期而误判为合法。
2. **可预测性强：** 秒级时间戳的生成规律性强，攻击者可基于当前时间推测未来时间戳值，并提前构造请求，降低安全性。

**面试回答：**

易受重放攻击、可预测性强。

---

### 46. ★★★★☆ 设计API签名时，拼接各个参数值时为什么要排序？

**参数排序原因：**

1. **保证签名一致性：** 不同编程语言或系统处理参数时，可能因字典或对象的无序性导致参数顺序不同。通过**按ASCII码或字典序**对参数名排序，可以确保签名双方使用相同的参数顺序拼接字符串，从而生成一致的签名值。
2. **避免歧义和逻辑错误：** 消除因顺序不一致导致的签名计算结果差异。

**面试回答：**

确保签名一致，避免因不同系统参数顺序不同导致签名不一致。按固定顺序（如字典序）排列参数，使双方生成相同签名。

---

### 47. ★★★★☆ 设计API签名时，为什么要增加分隔符？

1. **明确参数顺序：** 分隔符能清楚分开各个参数，防止不同参数拼接后结果相同（如参数A=`123`、B=`456`，无分隔符拼成`123456`，若顺序调换结果可能不变）。
2. **防止值冲突：** 参数值可能包含特殊字符或连接字符，使用固定分隔符可区分参数内容与分隔位置，保证解析准确。

**面试回答：**

明确参数顺序、防止值冲突。

---

### 48. ★★★★☆ 设计API签名时，HMAC SHA256和SHA256区别是什么？

| 对比维度 | SHA256 | HMAC SHA256 |
| :--- | :--- | :--- |
| **用途** | 生成数据摘要，验证**数据完整性**（如文件校验）。 | 基于密钥的哈希算法，验证消息的**完整性**和**发送者身份**（如API请求签名）。 |
| **密钥依赖** | **无需密钥**，相同输入始终生成相同的哈希值。 | **必须依赖共享密钥**，签名结果由密钥和消息共同决定。 |

**面试回答：**

1. **用途不同：** HMAC SHA256用于验证消息完整性和身份；SHA256用于生成数据摘要，如文件校验。
2. **是否依赖密钥：** HMAC SHA256需密钥，结果由密钥和消息共同决定；SHA256无需密钥，相同输入始终输出相同结果。

---

### 49. ★★★★☆ 一个接口入参中存在传入邮箱，有可能存在什么风险？

1. **邮箱注入攻击：** 攻击者可能通过注入特殊字符（如分号`;`）或非法邮箱格式，在单次请求中嵌入多个邮箱地址，导致批量发送邮件、伪造邮箱身份或绕过单邮箱限制。
2. **数据泄露与合规风险：** 邮箱是个人隐私信息，若未加密传输、未进行格式校验或未限制长度，可能被窃取、篡改，引发合规风险。

**面试回答：**

邮箱注入、数据泄露风险。

---

## 协议漏洞

### 50. ★★☆☆☆ HTTPS交互过程？

**理解记忆口诀：** 客户端打招呼（Hello），服务器亮身份（证书），双方算暗号（密钥交换），切换加密模式，安全聊天（传输）。

1. **ClientHello：** 客户端发送支持的协议版本、加密套件和随机数。
2. **ServerHello：** 服务器确认协议与算法，返回随机数和证书（含公钥），必要时发送密钥交换参数。
3. **密钥交换：** 客户端验证证书后，生成预主密钥并用服务器公钥加密发送；双方基于三个随机数（Client Random、Server Random、Pre-Master Secret）独立计算出会话密钥（Session Key）。
4. **加密切换（ChangeCipherSpec）：** 双方发送ChangeCipherSpec通知启用加密，并交换加密的Finished消息验证密钥一致性。
5. **数据传输：** 使用会话密钥对称加密数据，确保通信机密性与完整性。

**面试回答：**

客户端打招呼（Hello）→ 服务器亮身份（证书）→ 密钥交换（生成会话密钥）→ 切换加密模式（Finished）→ 数据传输（对称加密）。

---

### 51. ★★★☆☆ TLS1.2协议的攻击方法？

**理解记忆口诀：** 协议降级，弱密钥交换，证书伪造。

1. **协议降级攻击：** 攻击者篡改Client Hello消息，迫使双方放弃TLS1.2，改用TLS1.0、SSLv3等**旧协议**，再利用旧协议已知漏洞破解加密数据。
2. **弱密钥交换攻击：** 若TLS1.2使用RSA且**服务器私钥泄露**，攻击者可直接解密预主密钥；或使用DHE算法但**密钥参数过弱**（如长度小于2048位），攻击者可通过算力破解会话密钥。
3. **证书伪造与劫持攻击：** 攻击者伪造目标服务器的数字证书（如利用CA漏洞签发虚假证书），若客户端未严格验证证书，会误认攻击者是合法服务器，导致数据被窃取。

**面试回答：**

协议降级攻击、弱密钥交换攻击、证书伪造与劫持攻击。

---

### 52. ★★★☆☆ HTTP请求走私（HTTPRequest Smuggling）原理

**核心原理：** 多层服务器架构（前端代理→后端服务器）对HTTP请求的**边界判断不一致**（即对Content-Length和Transfer-Encoding的解析规则不同），导致攻击者能“藏”一段恶意请求，让其中一层服务器误以为是合法请求的一部分，另一层服务器则当成独立请求执行。

**常见构造方式：**

1. **CL-CL型：** 请求中设置两个数值不同的`Content-Length`头部。前端代理按第一个CL解析，后端服务器按第二个CL解析，后端将多余的内容当作下一个请求的开头，从而执行恶意请求。
2. **TE-CL型：** 请求中同时设置`Transfer-Encoding: chunked`和`Content-Length`。前端代理优先认TE按块解析请求体，后端服务器优先认CL按固定长度解析请求体，后端将前端已判定为“请求结束”后的内容，当作新的独立请求处理。

**面试回答：**

核心原理：前端代理和后端服务器对 `Content-Length` 和 `Transfer-Encoding` 的解析规则不一致，导致请求边界判断偏差。常见构造方式是 CL-CL型（双CL头）或 TE-CL型（CL和TE头同时存在），让后端服务器将恶意内容当作新请求执行。

---

### 53. ★★★☆☆ HTTPS握手过程如果一个IP上有多个域名，此时该返回哪个域名的证书？

1. **SNI（Server Name Indication）识别具体域名：** HTTPS握手时，客户端会告诉服务器要访问的**具体域名**，服务器就能从多个证书中找到对应的，返回给客户端，让后续加密通信匹配正确域名。
2. **泛域名证书适配多个子域名：** 如果多个域名是同一主域名下的子域名，服务器可配置**“泛域名证书”**（如`*.主域名`），能同时匹配所有子域名。

**面试回答：**

通过SNI识别具体域名，服务器返回对应证书。如果是子域名，可使用泛域名证书匹配。

---

### 54. ★★★★☆ 基于HTTPS交互逻辑， 如何实现让类似Burp等工具无法抓某个域名的包？

从客户端和服务器两个角度防范：

1. **客户端严格校验服务器证书合法性：** 采用**证书固定（SSL Pinning）技术**，客户端提前在代码中存储服务器的合法证书指纹或公钥；当Burp等工具用伪造证书拦截时，指纹不匹配，客户端直接拒绝建立连接。
2. **使用Burp不支持的加密算法与密钥策略：** 服务器只启用Burp未兼容的**强加密算法组合**（如新型的TLS 1.3专属套件），或频繁更新**会话密钥**，使抓包工具无法协商出合适的算法或持续解密数据。

**面试回答：**

客户端严格验证书（证书固定Pinning），服务器用Burp不支持的加密方式（强加密算法组合）。

---

### 55. ★★★★☆ 如果CA本身被攻击或有内鬼，签发了某个域名的证书如何解决？

1. **对非法证书进行吊销与公示：** CA或监管机构一旦发现非法签发的证书，会立即启动证书吊销流程，将该证书信息加入**“证书吊销列表（CRL）”**，或通过**“在线证书状态协议（OCSP）”**实时标记。客户端使用证书前会查询状态，若已吊销则拒绝认可。
2. **客户端防护：** 客户端（如浏览器、APP）会升级证书验证机制，采用**“证书固定（SSL Pinning）技术”**，提前存储目标域名的合法证书指纹，即使遇到CA非法签发的证书，只要指纹不匹配就拒绝连接。

**面试回答：**

吊销并公示非法证书（CRL/OCSP），客户端防护（证书固定SSL Pinning）。

---

### 56. ★★★☆☆ 什么场景下HSTS会失效？如何解决该风险？

**HSTS失效的常见场景：**

- **客户端首次访问目标域名时（TOFU问题）：** HSTS规则需要客户端（如浏览器）从服务器的响应头中获取并缓存。首次访问该域名时，客户端还未收到HSTS头，可能先发起HTTP请求，此时若被中间人劫持，就可能导致HSTS失效。

**解决HSTS失效风险的方法：**

1. **将域名加入HSTS预加载列表：** 向浏览器厂商（如Chrome、Firefox）提交申请，将域名加入预加载列表，这样即使是客户端首次访问，浏览器也能直接调用预加载的HSTS规则，强制使用HTTPS。
2. **通过TLS加密保护HSTS响应头并强化规则参数：** 服务器确保所有响应都通过HTTPS（TLS加密）传输，防止中间人篡改HSTS头；同时，在HSTS头中添加 `includeSubDomains` 和 `preload` 参数，进一步强化HSTS的执行效果。

**面试回答：**

- **失效场景：** 客户端第一次访问域名时（未缓存HSTS头），可能先发HTTP请求被中间人劫持。
- **解决方法：** 加入HSTS预加载列表（解决首次访问问题），通过TLS加密保护HSTS响应头并强化规则参数（如添加 `includeSubDomains`）。

---

### 57. ★★☆☆☆ DNSSEC能解决什么场景问题？

DNSSEC是给DNS地址簿加了“防伪锁”和“验真码”的安全体系。

1. **防止DNS欺骗（地址被改，跑错地方）：** DNSSEC通过为DNS响应添加**数字签名（RRSIG）**，确保用户接收到的解析结果来自合法的权威服务器而非伪造者，阻止用户被重定向到恶意网站。
2. **抵御中间人攻击（地址在传输中被换）：** DNSSEC通过验证响应中的数字签名，确保数据在传输过程中未被修改，即使攻击者截获通信也无法伪造合法签名。
3. **防止区域枚举（Zone Walking）：** DNSSEC引入**NSEC3记录**，通过哈希算法对域名进行加密处理，隐藏真实域名信息，有效阻止攻击者通过遍历子域名收集敏感数据。

**面试回答：**

防DNS欺骗、抵御中间人攻击、防止区域枚举。

---

### 58. ★★☆☆☆ CDN场景下的HTTPS证书安全如何保障？

**CDN（内容分发网络）：** 通过全球分布式节点加速内容传输的网络服务。

1. **证书选择与配置：** 优先使用受信任CA机构颁发的DV/OV/EV证书，包含**完整证书链**避免浏览器验证失败，通过CDN控制台配置证书并设置**自动更新机制**，防止证书过期。
2. **安全策略强化：** 通过CDN配置将所有HTTP请求**重定向至HTTPS**，设置**Strict-Transport-Security**头部强制浏览器仅通过HTTPS访问，添加**Content-Security-Policy**等安全头部防止XSS和点击劫持，并设置合理的**缓存控制策略**限制敏感资源缓存。

**面试回答：**

证书选择与配置（用CA证书，设置自动更新）、安全策略强化（HTTP重定向至HTTPS，设置HSTS头，设置CSP等安全头部）。

---

### 59. ★★☆☆☆ DNS中（DS、PTR、TXT）记录类型的常用作什么场景？

| 记录类型 | 核心功能 | 场景 |
| :--- | :--- | :--- |
| **DS记录** | DNSSEC的“子域名防伪介绍信”，存子域名的公钥哈希值。 | 确保子域名是主域名认可的正规域，防止子域名被伪造。 |
| **PTR记录** | **IP→域名**的反向解析（反向通讯录）。 | **防垃圾邮件**（验证发件IP的域名是否可信）、网络故障排查。 |
| **TXT记录** | 存储自定义文本信息（万能便利贴）。 | **域名所有权验证**（如网站备案）、**邮件安全配置**（如SPF、DKIM）。 |

**面试回答：**

DS记录用于DNSSEC安全验证，PTR记录用于IP反向解析（如防垃圾邮件），TXT记录用于域名所有权验证和邮件安全配置。

---

### 60. ★★★☆☆ 将暂时不用的域名解析到1.1.1.1有什么好处和坏处？

| 类别 | 描述 |
| :--- | :--- |
| **好处** | **简化管理与加速解析同步：** 临时解析可避免后续重新创建解析记录的麻烦，且解析记录能快速同步到全球DNS。 |
| **坏处** | **恶意劫持与法律合规风险：** 1.1.1.1是公共DNS服务器IP，若域名解析到此，可能被攻击者利用进行**恶意劫持**或**伪装攻击**，长期管理不当存在**法律风险**（因域名所有者责任）。 |

**面试回答：**

好处是简化管理、加速解析同步，坏处是恶意劫持和法律合规风险。

---

### 61. ★★★☆☆ OAuth除了最常见的redirect_uri绕过问题外，还有哪些风险以及如何修复？

**理解记忆口诀：** State参数用错，授权码能重复用或没期限，客户端密钥泄露

1. **State参数用错：** 攻击者能伪造请求绕过CSRF防护，逼用户授权恶意应用。
    - **修复：** 客户端生成**随机唯一的State**，服务端**严格核对**，别重复用。
2. **授权码能重复用或没期限：** 授权码被攻击者截获后可多次使用或长期保留。
    - **修复：** 设授权码**只能用一次**、**有效期短**（如5-10分钟），用后马上作废。
3. **客户端密钥泄露：** 密钥明文存或前端传，攻击者会盗用冒充正规应用。
    - **修复：** **加密存密钥**（如用Vault），别在前端暴露，定期更换。

**面试回答：**

State参数用错、授权码能重复用或没期限、客户端密钥泄露，并简述修复方案。

---

### 62. ★★★☆☆ JWT相较于SESSION优劣势？

| 类别 | 优势 | 劣势 |
| :--- | :--- | :--- |
| **JWT** | 1. **服务端无状态：** 令牌存储在客户端，服务端无需存储会话信息，**分布式扩展性更强**。 2. **跨域/跨服务调用：** 客户端直接携带Token，无需依赖Cookie，**灵活度更高**。 | 1. **客户端存储：** 容易受到**XSS攻击**窃取令牌（通常存在`localStorage`）。 2. **难撤回：** 令牌一旦签发，在有效期内**无法轻易撤销**，被盗后只能等过期。 |
| **SESSION**| 1. **安全性高：** 数据存在服务器，Token（Session ID）存在`HttpOnly` Cookie中，防XSS窃取。 2. **易撤销：** 服务器可随时删除会话数据，**实现即时注销**。 | 1. **分布式扩展性差：** 多服务器需配置SESSION共享（如Redis），增加复杂性和故障点。 2. **跨域限制：** 依赖Cookie传输Session ID，受限于同源策略，**跨域/跨服务调用复杂**。 |

**面试回答：**

优势：服务端无状态，分布式扩展性更强，支持跨域/跨服务调用。劣势：客户端存储易被XSS窃取，难撤回。

---

### 63. ★★★☆☆ 如何通过HTTP参数污染将uid=9527&amount=100中的uid改为10086？

**URL参数改写：**

- 将原请求 `uid=9527&amount=100` **修改为** `uid=9527&amount=100&uid=10086` **或** `uid=10086&amount=100&uid=9527`。
- **原理：** 利用HTTP协议允许多个同名参数同时存在，服务器解析时根据配置选择不同规则处理（如“取最后值”或“取最先值”）。

**面试回答：**

URL参数改写：将原请求 `uid=9527&amount=100` 修改为 `uid=9527&amount=100&uid=10086` 或 `uid=10086&amount=100&uid=9527`，利用服务器解析规则（如取最后值）来改变最终的 `uid`。

---

### 64. ★★★★★ 当网关对所有请求会进行一次强制urldecode，存在一个参数为 uid=9527&remark=充话费&amount=100的接口，仅备注字段（remark）可控时，如何改变最终的金额字段（amount）？

**核心思路：**

- 在可控的 `remark` 字段中，**提前存入编码后的特殊字符**（`&`、`=`、`#`），让网关解码后生成新的参数，并屏蔽原始参数。

**构造方法：**

1. **构造 `remark` 值：** `充话费%26amount%3D0%23`（即 `充话费&amount=0#` 的编码）。
2. **发送请求：** `uid=9527&remark=充话费%26amount%3D0%23&amount=100`。
3. **网关强制解码后：** 请求变为 `uid=9527&remark=充话费&amount=0#&amount=100`。
4. **后端服务器解析：** 忽略`#`及其后的内容，最终解析到的参数为：`uid=9527`、`remark=充话费`、`amount=0`。

**面试回答：**

在 `remark` 中，提前存入编码后的特殊字符，让网关解码后生成新的金额参数，屏蔽原始金额参数。

---

### 65. ★★★☆☆ Web缓存投毒的原理、利用和修复？

| 类别 | 描述 |
| :--- | :--- |
| **原理** | 缓存服务器和源服务器对**请求的判断（缓存键）不一致**，导致缓存服务器误把含恶意内容的响应当作正常内容缓存起来，后续用户访问时，拿到恶意内容。 |
| **利用** | 1. **注入恶意脚本：** 攻击者构造请求使源服务器返回带恶意脚本（如窃取Cookie）的页面，缓存后扩散。 2. **资源劫持：** 攻击者修改请求参数，让缓存里的正常文件被替换成攻击者的恶意文件（如JS文件），所有用户加载恶意文件。 |
| **修复** | 1. **统一解析规则：** 确保前端缓存服务器与后端源服务器对请求的参数、头部解析逻辑完全一致。 2. **严格过滤恶意输入：** 源服务器需对所有用户可控的请求参数、头部内容进行过滤。 3. **优化缓存策略：** 避免对包含用户特定信息、动态生成或可能被篡改的内容进行缓存，设置合理过期时间。 |

**面试回答：**

原理（解析不一致导致恶意内容被缓存）、利用（注入恶意脚本、资源劫持）、修复（统一解析规则、过滤恶意输入、优化缓存策略）。

---

### 66. ★★★★☆ Web缓存投毒中，针对200的状态错误如何彻底修复？

**（针对正常响应被恶意缓存的修复）**

1. **精细化配置缓存键（Cache Key）：** 缓存系统需将**完整URL**（含查询参数）、**请求方法**及**关键头部**（如Host）共同纳入缓存键的生成逻辑。特别需配置 `Vary` 响应头精确标识影响内容的关键元素（如`Vary: User-Agent`）。
2. **请求与内容的关联性验证：** 对影响缓存内容的请求参数实施严格校验（格式、范围、合法性）。服务端需为关键内容添加安全令牌（如`X-Content-Type-Options: nosniff`），强制浏览器不执行异常内容。重要操作必须使用**POST**而非GET方法，避免操作被缓存。

**面试回答：**

精细配缓存键（Cache Key，需包含完整URL、Host、Vary头），验证请求和内容（严格校验参数，加 `X-Content-Type-Options` 安全令牌，重要操作用POST防缓存）。

---

## 🔐 算法安全

### 67. ★☆☆☆☆ 常见加解密分类和算法有哪些？

| 分类 | 算法名称 | 特点 |
| :--- | :--- | :--- |
| **对称加密**| AES、SM4（国密）、DES（淘汰）| 加解密使用**相同密钥**，效率高，适合加密大量数据，需安全传递密钥。 |
| **非对称加密**| RSA、ECDH/ECDSA、SM2（国密）| 使用**公钥和私钥成对**操作，解决密钥分发问题，计算速度较慢。 |
| **消息摘要（哈希）**| SHA-256、SM3（国密）、MD5（淘汰）| **单向不可逆**，生成固定长度摘要，用于验证数据完整性。 |

**面试回答：**

对称加密算法（AES、SM4）、非对称加密算法（RSA、ECDH/ECDSA、SM2）、消息摘要算法（SHA-256、SM3、MD5）。

---

### 68. ★★☆☆☆ 哪些Hash和加密算法不建议使用？

**一、不安全，不建议使用的算法**

1. **DES（数据加密标准）：** 密钥仅56位，易被**暴力破解**。
2. **MD5（消息摘要算法）：** 存在**碰撞漏洞**（不同数据可生成相同哈希值），不能用于高安全场景。
3. **3DES（三重数据加密算法）：** 仍依赖DES核心机制，**加密慢**，难抵御复杂攻击。

**二、因密钥长度影响安全性，需注意使用条件的算法**

1. **AES（高级加密标准）：** 密钥长度**低于128位**易被暴力破解，推荐128位及以上。
2. **RSA（非对称加密算法）：** 密钥长度**低于2048位**易被破解，推荐2048位及以上。

**面试回答：**

不安全算法：DES、MD5、3DES。需注意密钥长度的算法：AES（低于128位）、RSA（低于2048位）。

---

### 69. ★★★☆☆ 对称加密的块式加密和流式加密相同与不同点？

| 对比维度 | 块式加密（如AES） | 流式加密（如RC4） |
| :--- | :--- | :--- |
| **相同点** | **都遵循对称加密的核心规则**（加解密使用同一个密钥）。 |
| **数据处理单位** | 将数据分割成多个**固定长度**的“数据块”（如128位），每次加密操作针对一个块。 | **不分割数据**，每次仅对数据中的一个字节或一个比特进行加密，处理单位更小。 |
| **适用场景** | 逻辑稳定，适合对**文件、数据库存储数据**等静态、完整数据加密。 | 实时逐单位处理，**延迟较低**，适合对**实时传输的数据流**（如语音通话、视频流）加密。 |

**面试回答：**

相同点是都是对称加密。不同点在数据处理单位（块式是固定块，流式是逐字节）和适用场景（块式适合文件存储，流式适合实时传输）。

---

### 70. ★★★☆☆ DES的回放攻击原理？以及如何解决？

**原理：**

- DES采用**ECB（电子密码本）模式**时，相同的明文块使用相同密钥必然生成完全相同的密文块。攻击者可捕获并重复发送特定密文块（如转账指令），导致服务器重复执行操作。

**防御：**

1. **基础防御：** 采用**CBC（密码块链）模式**。每个明文块加密前会与前一个密文块进行异或运算（XOR），使相同明文在不同位置/时间加密后产生不同密文，消除可重放特征。
2. **协议层防护：** 在数据包中添加**时间戳**（timestamp）和**序列号**（sequence number）。服务器校验时间戳的时效性（拒绝旧请求），并维护已处理序列号的白名单，拒绝重复序列号请求。

**面试回答：**

原理是DES-ECB模式相同明文加密后密文相同，攻击者重发密文可让服务器重复操作。防御是改用CBC模式（消除固定密文特征），并在数据包中加入时间戳和序列号（协议层防重放）。

---

### 71. ★★★☆☆ 3DES相较于DES差异？

| 对比维度 | DES（数据加密标准） | 3DES（三重数据加密算法） |
| :--- | :--- | :--- |
| **密钥长度** | 56位。密钥空间小，易被暴力破解。 | 通常为168位（由3个56位的DES密钥组成）。密钥空间显著扩大，**抗暴力攻击能力强**。 |
| **加密过程** | 对数据进行**单次**加密操作。 | 对数据进行**三次**DES加密操作，通常采用“加密-解密-加密”（EDE）的模式，增强加密强度。 |

**面试回答：**

密钥长度：DES用56位密钥，易破解；3DES常用168位，难破解。加密过程：DES加密一次；3DES要加密三次（EDE模式）。

---

### 72. ★★★★☆ 有什么算法可以解决RSA私钥可能泄露的问题？

解决RSA私钥可能泄露的问题，核心是使用“密钥交换”算法，避免长期私钥被传输和长期依赖。

1. **DH（Diffie-Hellman）算法：** 双方在通信前**无需提前共享私钥**，仅各自在本地生成密钥对，交换公钥；再用自己的私钥和对方公钥计算出一个**相同**的“共享密钥”。整个过程中，私钥始终只在本地生成和使用，**不会通过网络传输**，大幅降低私钥在传输中被窃取的可能。
2. **ECDH（椭圆曲线Diffie-Hellman）算法：** DH算法的变体，逻辑与DH一致。在达到相同安全强度时，**私钥长度更短**，计算和存储成本更低，更适合资源受限的移动设备和物联网场景。
3. **ECDHE（ECDH Ephemeral）算法：** **每次通信都临时生成密钥**（Ephemeral，临时性），用完即弃，即使未来长期私钥泄露，**之前加密的通信内容也无法解密**（具备前向安全性）。现代HTTPS优先采用ECDHE。

**面试回答：**

DH算法（通过公钥交换算出共享密钥，私钥不传输）、ECDH算法（DH的升级版，密钥更短、效率更高）、ECDHE算法（每次通信都临时生成密钥，具备前向安全性，是现代HTTPS的标准）。

---

### 73. ★★★★☆ 有哪些可能的绕过签名方式？

1. **利用签名验证逻辑的缺陷：** 如果签名验证代码存在bug（例如未正确处理格式、边界条件或错误状态），攻击者可以输入**畸形签名**或**特定输入**被错误地视为有效，从而绕过验证流程。
2. **私钥泄露：** 如果签名私钥被窃取或泄露，攻击者可以直接用真实私钥**伪造新签名**；系统无法区分合法用户与攻击者，导致签名验证机制被无效化。

**面试回答：**

利用签名验证逻辑的缺陷（如输入畸形签名，被误判为有效），私钥泄露（攻击者用真实私钥伪造签名）。

---

## 供应链安全

### 74. ★★★☆☆ 引入三方商业软件，部署时如何进行安全防护？

1. **部署环境的安全加固：** 部署前，需为承载软件的基础环境（如操作系统、数据库、服务器）安装**最新安全补丁**，关闭无需使用的端口和服务（如FTP），并通过防火墙**划分隔离区域**，将三方软件所在环境与核心业务系统隔离开。
2. **部署过程的安全配置：** 按**“最小权限、最小暴露”**原则配置软件参数，分配**最小必要权限**，关闭软件默认开启的非必要功能（如调试模式、匿名访问），对敏感配置信息（如数据库连接密码、API密钥）进行**加密存储**，禁用默认账号或修改默认密码。

**面试回答：**

部署环境的安全加固（打补丁、关端口、划分隔离区），部署过程的安全配置（最小权限、关默认功能、加密存敏感信息、改默认密码）。

---

### 75. ★★★☆☆ Maven源的安全性需要考虑哪些点？

**Maven源：** 存储和分发Java项目依赖包（jar包）的仓库。

1. **源的官方性与可信度：** 优先使用**官方仓库**（如Maven中央仓库）或行业内知名、长期稳定运行的第三方源，**避免非官方或小众源**被恶意注入有害代码、替换正常依赖包。
2. **依赖包的完整性校验：** 确认Maven源支持依赖包的**校验和或数字签名验证**，下载后自动比对校验信息，确保下载的包与源上存储的一致，**未被中途篡改**。

**面试回答：**

选择靠谱的源（官方、知名源），校验包的完整性（校验和或数字签名）。

---

### 76. ★★★☆☆ 如何识别依赖的三方组件（jar/pip/npm包）的后门、投毒？

1. **组件来源可信度验证：** 优先从**官方仓库**下载组件，检查发布者认证状态，避免使用来源不明的镜像站。扫描组件依赖树，递归检测所有间接依赖项是否包含**已知恶意包**。
2. **静态代码特征分析：** 使用静态扫描工具（如Snyk、CodeQL）检查组件代码中的危险模式。重点检测高风险行为：包含**加密矿机代码**、**硬编码密钥或密码**、**敏感系统调用**（如`Runtime.exec()`）、**隐蔽网络通信**（如连接非常规域名）。
3. **动态行为监控与沙箱测试：** 在隔离**沙箱**（如Docker容器）中运行组件，监控其运行时行为。捕获异常活动：**未声明的网络请求**（特别是到恶意IP的链接）、**文件系统篡改**（如修改`/etc/passwd`）、进程注入尝试或异常权限申请。

**面试回答：**

查组件来源（官方、认证状态），分析代码特征（扫矿机代码、硬编码密钥、敏感系统调用），监控运行行为（沙箱测试、抓包、跟踪系统调用）。

---

## 安全扫描器

### 77. ★★★☆☆ 灰盒相较于黑白盒的优势是什么？

| 类别 | 优势 |
| :--- | :--- |
| **测试效率更高** | 结合黑盒的外部视角和白盒的部分内部信息，知道关键逻辑或接口规则就能设计用例，减少学习和测试时间，使**用例更有针对性**。 |
| **测试覆盖更广** | 既查输入输出，也查模块间交互和内部逻辑，能同时验证模块组合功能和数据传递，弥补黑盒漏内部错误、白盒难覆盖用户场景的问题。 |
| **平衡深度与广度**| 只关注关键路径和核心逻辑，有限资源下挖缺陷更高效。 |

**面试回答：**

测试效率更高、测试覆盖更广、平衡深度与广度。

---

### 78. 哪个安全Hook点在常见业务场景中对性能影响最大？

**最核心影响Hook点：** 系统调用、内核态与用户态切换。

1. **系统调用（如文件读写、网络收发）：** 系统调用是应用程序执行基础操作的必经路径，会被频繁触发。Hook需要在每次调用时插入额外的检查逻辑（如扫描文件内容、验证数据包），直接增加CPU负载。若Hook点涉及进程创建，会导致多进程应用启动速度明显下降。
2. **内核态与用户态切换：** 系统调用执行需要从用户态切换到内核态，Hook若在此过程中拦截调用，会进一步加剧上下文切换的资源消耗。这种开销在高并发场景下尤为明显，可能导致响应延迟显著上升。

**面试回答：**

系统调用和内核态与用户态切换。

---

### 79. ★★★☆☆ 当前阶段，人工和自动化的代码审计差异点在哪里？

| 对比维度 | 人工代码审计 | 自动化代码审计 |
| :--- | :--- | :--- |
| **漏洞发现逻辑** | **逻辑链完整性验证：** 通过经验、威胁建模推演潜在漏洞（如权限绕过、业务流缺陷），侧重“逻辑”漏洞。 | **规则模板匹配：** 基于预定义规则集（危险函数匹配）、数据流分析（污点传播），只能检出**符合模板**的漏洞（如SQL注入、缓冲区溢出）。 |
| **业务理解** | **具备业务理解：** 能关联业务场景（如优惠券逻辑需校验库存），识别**业务逻辑漏洞**。 | **缺乏业务理解：** 无法理解业务语义和上下文，无法识别业务逻辑漏洞。 |

**面试回答：**

漏洞发现逻辑的差异（人工查逻辑链完整性，自动化靠规则模板匹配）、业务理解差异（人工懂业务，自动化不懂业务）。

---

### 80. ★★★☆☆ 什么类型漏洞是代码审计无法准确判断存在与否的？

**（代码审计是静态分析，无法模拟运行环境和动态交互）**

1. **环境依赖型漏洞：** 某些漏洞仅在**特定运行环境**（如特定操作系统版本、中间件配置或网络拓扑）下才会触发。例如，未授权访问的Redis服务漏洞依赖**端口开放状态**，代码审计无法验证实际部署环境中的漏洞是否存在。
2. **动态运行时漏洞：** 动态漏洞（如**会话固定漏洞**或某些类型的**内存溢出漏洞**）需要在程序运行过程中才能暴露。代码审计无法捕捉运行时的状态变化或动态交互行为，因此可能遗漏此类漏洞。

**面试回答：**

环境依赖型漏洞（如Redis未授权访问），动态运行时漏洞（如会话固定、内存溢出）。

---

### 81. ★★★☆☆ 密钥的识别的正则如何写？

**核心原理：** 密钥通常是**十六进制字符**（`[0-9a-fA-F]`）组成，且具有**固定长度或特定前缀**。

1. **API密钥（带特定前缀）：** 如`^sk_[A-Za-z0-9_]{20,40}$`（`sk_`是固定前缀，`{20,40}`限定长度）。
2. **UUID（通用唯一识别码）：** 格式为8位-4位-4位-4位-12位。如`^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$`。
3. **哈希类密钥（如MD5、SHA系列）：** 固定长度十六进制字符组成。如MD5（32位）：`^[0-9a-fA-F]{32}$`。

**面试回答：**

可举例3种类型：API密钥（带前缀，如 `^sk_[A-Za-z0-9_]{20,40}$`），UUID（固定分段格式），哈希类密钥（固定长度十六进制，如MD5的32位）。

---

### 82. ★★★☆☆ 正则`(a+)+`会存在什么风险？

**风险：** 正则表达式拒绝服务（ReDoS）攻击。

- **原理：** `(a+)+` 使用了**嵌套分组**（括号套括号），这会导致正则引擎在匹配**长字符串**且**匹配失败**（如`aaaaaX`）时，陷入**“回溯”**（反复试错）的陷阱。输入的字符越多，需要试的组合方式呈指数级增长，最终消耗大量CPU和内存资源，导致系统崩溃或响应极慢。
- **解决：** 简化正则，去除不必要的嵌套，如直接写成 `a+`。

**面试回答：**

正则拒绝服务（ReDoS）攻击。因为它使用了嵌套分组，在匹配长字符串且匹配失败时，会触发正则引擎的指数级**“回溯”**（反复试错），导致CPU和内存耗尽，系统瘫痪。

---

### 83. ★★★☆☆ 程序对读取的文件名的正则为`/\.markdown/`，如何绕过？

**正则含义：** `/\.markdown/` 匹配文件名中包含 `.markdown` **子串**的文件。

**绕过方法：**

- **在 `.markdown` 后添加额外内容：** 例如构造文件名 `file.markdown.txt` 或 `doc.markdown_123`。文件名中包含 `.markdown` 子串，会被正则匹配通过，但实际文件的有效扩展名是后面的 `.txt` 或 `_123`，从而绕过了“只能处理 markdown 类型文件”的限制。
- **利用路径分隔符包含 `.markdown`：** 例如构造路径 `dir/file.markdown/../data`。该路径包含 `.markdown`，但实际访问的是 `dir/data` 文件。

**面试回答：**

在 `.markdown` 后添加额外内容（如 `file.markdown.txt`），或利用路径分隔符（如 `dir/file.markdown/../data`）。

---

### 84. ★★★☆☆ 解释型语言和编译型语言在语法树分析上有什么差异？

| 对比维度 | 编译型语言（如C、C++） | 解释型语言（如Python、JavaScript） |
| :--- | :--- | :--- |
| **分析时机** | **编译前一次性分析：** 在代码执行前的“编译阶段”一次性完成，整个源代码会被完整扫描并生成对应的语法树。 | **运行时逐段分析：** 语法树分析会伴随代码运行同步进行，解释器每读取一段代码，就立即对这段代码进行语法树分析，分析完成后直接执行。 |

**面试回答：**

分析时机不同：编译型语言（如C、C++）在编译前一次性分析整个代码，生成语法树；解释型语言（如Python、JavaScript）在运行时逐段分析代码，边读边执行。

---

### 85. ★★★☆☆ Java Web应用中的反序列化漏洞的Source和Sink是什么？

- **Source：** 攻击者能控制的输入。通常指用户提交的**请求参数、Cookie、Session 数据、HTTP 头信息**或文件上传内容。这些输入未经过充分校验，可能直接作为反序列化的数据源。
- **Sink：** 代码里调用反序列化方法的地方。指程序中实际调用反序列化方法的代码点，例如 `ObjectInputStream.readObject()`、`Jackson` 的 `ObjectMapper.readValue()` 或 `Gson.fromJson()`。

**面试回答：**

Source是攻击者能控制的输入（如请求参数、Cookie），Sink是代码里调用反序列化方法的地方（如`ObjectInputStream.readObject()`）。漏洞的本质是Source提供恶意数据，Sink执行危险操作。

---

### 86. ★★★☆☆ 黑盒如何检测XSS漏洞？

1. **输入特殊字符测试（基本测试）：** 在输入框（如搜索框、表单）中输入`<>`等特殊字符，提交后查看页面源码或响应内容，如果输入内容**未被转义**，则可能存在XSS漏洞。
2. **链接参数测试（反射型XSS）：** 修改URL中的参数值，注入恶意代码，例如将 `http://example.com?search=abc` 改为 `http://example.com?search=<script>alert(1)</script>`，查看页面是否直接输出参数值且未过滤。
3. **工具辅助扫描：** 使用自动化工具（如Burp Suite、OWASP ZAP）发送大量XSS测试用例，分析响应内容是否包含未过滤的恶意代码。

**面试回答：**

输特殊字符测、改链接参数测、用工具扫。

---

### 87. ★★☆☆☆ 甲方黑盒是否应该有爬取流量功能？

| 角度 | 结论 |
| :--- | :--- |
| **从测试需求角度** | **部分场景有必要：** 当需要验证系统在真实业务流量下的功能完整性、兼容性或异常处理能力时，爬取流量功能能提供支持，但仅聚焦于单个接口功能时，则非必需。 |
| **从合规与数据安全角度**| **需严格限制前提：** 爬取流量必然涉及业务数据和用户隐私，**必须符合《个人信息保护法》等法规要求**。若无法对爬取的流量进行**实时脱敏处理**，或未获得内部数据使用授权，则不应添加该功能。 |
| **从风险控制角度**| **需配套完善的管理措施：** 必须设置严格的**访问权限**、记录所有操作的**日志**、限制爬取范围、禁止将数据用于测试以外的用途。 |

**面试回答：**

看测试需求（部分场景有必要），看合规安全（需严格限制前提，无法脱敏不应加），看风险控制（需配套完善的管理措施和日志）。

---

### 88. ★★★☆☆ 黑盒如何扫描无法出网的SSRF？

**（针对无法通过公网反连验证的SSRF）**

1. **本地协议利用：** 通过构造特定协议的URL（如 `file:///etc/passwd` 或 `gopher://127.0.0.1:22`），尝试**读取服务器本地文件**或**与本地服务交互**，观察返回内容或错误信息。
2. **盲打测试与内部服务探测：** 利用服务器**内部服务的响应特征**进行验证。例如，输入 `dict://127.0.0.1:22` 后，若页面返回SSH服务信息（如版本号），则说明请求成功到达本地端口。
3. **工具辅助扫描：** 使用如`Surf`、`autoSSRF` 等工具自动探测内网IP或本地协议漏洞，生成绕过白名单的Payload，动态测试内网访问可能性。

**面试回答：**

本地协议利用（如`file://`），盲打测试与内部服务探测（如 `dict://127.0.0.1:22`），工具辅助扫描。

---

### 89. ★★★☆☆ 黑盒如何扫描越权漏洞？

1. **看响应内容与状态码（垂直越权）：** 对比不同权限请求的响应结果。例如，普通用户请求管理员专属接口时，若返回了管理员权限下的操作列表或数据，且HTTP状态码为 **200 OK**（而非403/401）。
2. **测试跨用户资源访问（水平越权）：** 通过修改请求参数（如订单ID、文件ID）尝试访问其他用户的资源。例如，将 `order_id=1001` 改为 `order_id=2001`，若系统返回了其他用户订单的详细信息。

**面试回答：**

看响应内容和状态码（查垂直越权），测跨用户资源访问（查水平越权）。

---

### 90. ★★★★☆ 黑盒带登录态扫描如何规避业务影响？

1. **使用测试环境或影子环境：** 在测试环境或影子环境中执行扫描任务，避免直接访问生产环境数据库或业务接口，确保扫描产生的数据不会污染真实用户数据。
2. **参数过滤与打标：** 通过SAST/IAST工具对接口参数进行分类，过滤掉明显涉及用户敏感信息的参数（如phone、token），**对包含敏感字段值进行脱敏或替换**，防止扫描请求触发业务逻辑（如频繁发送验证码）。
3. **限制扫描范围与频率：** 在扫描过程中设置参数**白名单**或调用**次数上限**，避免高频请求对服务器造成负载压力，选择在**非业务高峰期**（如凌晨）执行扫描任务。

**面试回答：**

用测试/影子环境，过滤参数并打标（脱敏/替换），限扫描范围和频率（白名单/次数上限/非高峰期）。

---

### 91. ★★★★☆ 黑盒扫描时如何避免被反制？

**（避免被WAF、流量监控系统识别为“恶意机器”拦截或封禁）**

1. **控制扫描频率与流量：** 黑盒扫描需将请求频率和流量控制在**正常用户行为的合理范围内**（如设置与人类操作节奏相近的请求间隔），避免短时间内从同一来源发送大量请求，降低被流量监控机制标记为异常的风险。
2. **伪装请求特征：** 修改扫描工具的请求头信息，使其与正常用户使用的浏览器或客户端一致。比如使用常见的**User-Agent**（如Chrome、Safari的默认标识），添加合理的**Referer**、**Cookie**等字段，并确保请求格式符合目标系统的正常交互规范，让WAF难以通过请求特征区分扫描流量和正常用户流量。

**面试回答：**

控扫描频率和流量（设正常间隔，避开爆发时间），伪装请求特征（用常见User-Agent，加Referer、Cookie）。

---

## 漏洞处置

### 92. ★★☆☆☆ 漏洞的修复时间需要考虑哪些因素？

1. **漏洞的严重程度：** 严重程度是核心依据。**高危漏洞**（如可直接远程攻击）需立即修复（24-72小时内），**中危**（需特定条件利用）可在1-2周内，**低危**可在月度/季度更新中统一修复。
2. **受影响系统的重要性：** **核心业务系统**（如支付系统、用户数据中心）一旦出现漏洞，即使是中危也需缩短修复时间。
3. **漏洞被利用的可能性：** **已公开EXP**（漏洞利用工具）、在同类系统中已被实际攻击的漏洞，需优先修复。

**面试回答：**

漏洞严重程度、受影响系统的重要性、漏洞被利用的可能性。

---

### 93. ★★★☆☆ 如何有效提升漏洞修复效率？

1. **漏洞优先级评估：** 根据漏洞的**严重性、影响范围、资产重要性及修复成本**等因素，对漏洞进行量化评分并划分优先级，避免资源浪费在低价值漏洞上。
2. **自动化工具部署：** 使用漏洞扫描工具（如Nessus）和**补丁管理工具**（如Tenable.io）**自动化检测和修复**漏洞，减少人工干预。结合AI算法优化扫描策略，降低误报率。
3. **标准化修复流程：** 将漏洞修复流程拆分为**发现、处理、验证和闭环**四个阶段，并**明确各阶段的责任人**（如安全人员转交运维，运维修复后安全复查），确保每个环节高效衔接。

**面试回答：**

评漏洞优先级、部署自动化工具、标准化修复流程。

---

### 94. ★★★★☆ 外部白帽子发现某个高危漏洞，但完整修复需要多天，安全产品的止血手段不彻底，你该如何处置？

1. **实施临时访问控制或功能隔离（弥补安全产品不足）：** 针对漏洞影响的业务接口或功能，在防火墙或负载均衡设备上添加规则，**仅允许内部特定IP地址访问该接口**，禁止外部公网直接访问；若涉及非核心业务，可**暂时停用该功能模块**，待修复完成后再启用。
2. **制定清晰的分阶段修复计划并推进（确保进展）：** 联合开发、运维、安全团队拆解修复任务，制定分阶段的修复时间表，**确保每天都有明确进展**（如第一天紧急补丁，第二天测试，第三天灰度部署），避免修复工作拖延。
3. **加强漏洞相关区域的实时监控与告警（预防被利用）：** 部署更密集的监控规则，实时追踪异常访问行为，设置告警阈值（如单IP短时间内发起10次以上包含漏洞特征的请求即触发告警），安排专人**24小时值守**告警平台，一旦发现疑似利用行为，立即采取临时**阻断措施**（如封禁异常IP）。

**面试回答：**

临时控接口/停功能（内部白名单、功能隔离）、制定分阶段修复计划（确保每日进展）、加强监控告警（24小时值守、设置高频告警阈值）。

---

## 前端/移动端安全

### 95. ★★☆☆☆ 如何发现网页被劫持了？

1. **用 CSP（内容安全策略）发现网页劫持：** 在网页的HTTP头或HTML标签中配置CSP规则，**限制网页只能加载指定来源的资源**（如脚本、样式表）。当网页被劫持时，CSP会阻止加载外部恶意脚本，并在浏览器控制台输出错误日志（如 `Blocked by Content Security Policy`），通过定期检查CSP报告日志可快速发现异常资源请求。
2. **用 `performance.getEntries()` 发现网页劫持：** 使用该方法获取网页加载过程中所有资源的性能数据，包括资源URL。遍历返回的资源列表，检查是否存在与预期不符的**外部域名**（如 `https://malicious.com/ads.js`）或异常文件类型，确认是否为劫持导致的非法注入。

**面试回答：**

用CSP（内容安全策略）发现网页劫持（限制加载资源来源），用 `performance.getEntries()` 发现网页劫持（检查加载的资源列表是否有陌生域名）。

---

### 96. ★★☆☆☆ iOS 取证工具——MVT的功能有哪些？

**MVT（Mobile Verification Toolkit）：** 开源移动设备取证工具，用于检测 iOS 设备是否被潜在恶意软件（如间谍软件）感染。

1. **越狱获得root权限（基础前提）：** MVT的核心功能需在越狱设备上获取root权限，才能突破系统限制，访问底层数据。
2. **提取敏感数据和日志：** MVT能直接访问越狱iOS的文件系统，提取**钥匙串**（存密码密钥）、**系统日志**、**应用数据**（如通信记录、位置历史），帮助分析应用痕迹。
3. **生成时间线关联事件：** MVT按时间戳排数据，生成**时间轴**，帮助安全人员重建攻击链或行为轨迹。

**面试回答：**

越狱获得root权限、提取敏感数据和日志、生成时间线关联事件。

---

### 97. ★★☆☆☆ 前端Javascript代码如何混淆以及反调试？

| 类别 | 工具/方案 | 描述 |
| :--- | :--- | :--- |
| **混淆工具** | **JavaScript Obfuscator：** | **高强度混淆**（变量加密、字符串加密、逻辑打乱），适合保护核心代码。 |
| | **Terser：** | **轻量混淆 + 压缩**（简化变量名、删除冗余），适合生产环境平衡安全与性能。 |
| **反调试方案**| **anti-debugger 库：** | 检测开发者工具（控制台、断点），触发时执行自定义逻辑（如弹窗、冻结页面）。 |
| | **自定义代码：** | 循环`debugger`语句干扰调试、检测控制台打开状态（利用console特性）等。 |

**面试回答：**

混淆工具：高强度混淆（JavaScript Obfuscator）和轻量混淆（Terser）。反调试方案：用`anti-debugger`库或自定义代码（循环`debugger`语句）。

---

### 98. ★★★☆☆ 如何实现当前页面`location.href`改变后，仍然能执行之前页面的JavaScript？

**核心机制：** 监听 `unload` 事件。

- **监听 `unload` 事件：** 在页面卸载前通过 `window.addEventListener('unload', callback)` 注册回调函数，当页面跳转时自动触发该函数。
- **发送请求可靠性：** 在 `unload` 事件中，浏览器可能中断未完成的请求（如AJAX `fetch`），建议使用 **`navigator.sendBeacon()`** 发送日志或清理资源，以提高可靠性（`sendBeacon`是专门为页面卸载时发送少量数据设计的）。

**面试回答：**

监听 `unload` 事件，在回调函数中执行JS代码。为保证请求可靠性，建议使用 `navigator.sendBeacon()`（而非`fetch`）发送日志或清理资源。

---

### 99. ★★★☆☆ APK反编译有哪几种路径，代表工具有哪些？

| 路径 | 描述 | 代表工具 |
| :--- | :--- | :--- |
| **路径一：** `dex` → `class/jar` → `java` | 通过将`.dex`文件转换为Java字节码（`class/jar`），再进一步反编译为Java源代码。 | `Enjarify`/`dex2jar`（转jar）→ `jd-gui`/`CFR`（转Java） |
| **路径二：** `dex` → `smali` → `java` | 将`.dex`文件转换为Smali汇编语言（底层逻辑），再尝试还原为Java代码。 | `ApkTool`（转Smali）→ `smali2java`（转Java，需人工调整） |

**面试回答：**

路径一（`dex`→`jar`→`java`）：用`dex2jar`转jar包，再用`jd-gui`转Java代码。路径二（`dex`→`smali`→`java`）：用`ApkTool`转Smali汇编，再转Java代码。

---

### 100. ★★☆☆☆ 静态apk反编译对抗有哪些手法？

**对抗目标：** 破坏反编译工具对文件的识别和解析。

1. **修改配置文件标识：** 修改 `AndroidManifest.xml` 开头的**MagicNumber**（固定标识），反编译工具会因无法识别文件格式而跳过解析。
2. **给dex插非法指令：** 在 `classes.dex` 中插入**非法指令**（如`FF FF`），反编译工具在解析时会因遇到无效操作码而中断流程。
3. **验证APK完整性：** 在代码中嵌入校验逻辑（如在 `Application` 类的 `onCreate` 方法），运行时计算APK文件的**哈希值**与预设值比对，若不匹配则**终止应用运行**。

**面试回答：**

改配置文件标识、给dex插非法指令、验证APK完整性。

---

### 101. ★★★☆☆ 静态特征码对抗方式？

**静态特征码：** 检测工具（如杀毒软件）提取的应用代码、字符串、包名等固定特征。

1. **加固敏感函数与指令：** 对敏感函数（如加解密、通信的核心函数）进行**加壳**（加密包裹）、**代码虚拟化**或**指令替换**，使其在静态分析时无法呈现原始形态，避开基于特征的扫描。
2. **混淆关键信息：** 对易被作为静态特征的内容进行打乱或隐藏，如将“服务器地址”“密钥”等**敏感字符串加密存储**，将有意义的函数名（如`login`）重命名为无意义的**短字符**（如`a`）。
3. **自动改唯一标识：** 利用自动化工具批量生成应用的不同版本，修改每个版本中具有唯一性的静态标识，如**随机修改包名后缀**、使用**不同的临时签名证书**、在应用名称中添加随机字符，让检测工具针对某一版本的特征码，无法匹配到其他版本。

**面试回答：**

加固敏感函数/指令（加壳、虚拟化）、混淆关键信息（字符串加密、函数名混淆）、自动改唯一标识（改包名、签名证书、应用名）。

---

### 102. ★★★☆☆ App自检升级场景下会存在哪些风险？

1. **兼容性问题：** App在升级后可能因新版本与**旧设备系统、硬件或第三方组件不兼容**，导致功能异常或无法运行（如闪退、卡顿），影响用户体验。
2. **数据丢失或损坏：** 升级过程中若未正确备份用户数据，或新版本对**数据格式**进行了调整，可能导致原有数据无法读取或丢失（如本地存储文件损坏）。
3. **恶意劫持或换包风险：** 若升级流程未严格校验下载源或安装包完整性，攻击者可能通过篡改升级链接或替换安装包，向用户推送**恶意软件**（如植入病毒或窃取信息），威胁用户隐私和设备安全。

**面试回答：**

兼容性问题、数据丢失或损坏、恶意劫持或换包风险。

---

### 103. ★★★☆☆ 如何设计一套通信机制，能够保证传输过程中的完整性、不可抵赖性以及防止重放？

| 安全目标 | 技术手段 | 描述 |
| :--- | :--- | :--- |
| **完整性** | **带密钥的哈希校验（HMAC）** | 发送方用**共享密钥**和数据计算**HMAC**摘要；接收方用相同密钥重新计算并比对，一致则数据未被篡改。 |
| **不可抵赖性**| **非对称数字签名** | 发送方用**私钥**对数据摘要加密生成**数字签名**；接收方用发送方的**公钥**解密并与原始摘要比对，只有私钥持有者能生成，发送方无法否认。 |
| **防重放** | **唯一请求令牌 + 去重机制** | 发送方在每次请求中加入**全局唯一的请求令牌**（如UUID）和**时间戳**；接收方检查令牌是否在**“已处理缓存池”**中（去重），并校验时间戳是否有效，确保同一请求不会被重复处理。 |

**面试回答：**

“带密钥的哈希校验”保传输完整性、“非对称数字签名”保不可抵赖性、“唯一请求令牌+去重机制”防重放。

---

## 威胁感知与响应面试题目

### 104. ★☆☆☆☆ 威胁感知可以在哪些层面进行？

1. **网络层威胁感知：** 针对网络中传输的**流量**进行监控与分析，识别异常网络行为与攻击流量（如端口扫描、DDoS攻击），常用IDS/IPS。
2. **主机终端层威胁感知：** 聚焦于服务器、PC等终端设备的**系统状态与运行行为**，监控主机内部的异常活动（如异常进程、文件修改、未授权登录），常用EDR。
3. **数据层威胁感知：** 以核心**数据资产的流转与使用**为监控重点，识别数据安全风险（如未授权的数据读取、数据异常传输），常用DLP、数据库审计。

**面试回答：**

网络层、主机终端层、数据层。

---

### 105. ★★☆☆☆ 常见的调试方法和检测方法？

| 类别 | 方法 | 描述 |
| :--- | :--- | :--- |
| **调试方法** | **断点调试** | 在代码关键位置设置断点，暂停程序后查看变量、调用栈、内存状态等信息，逐步分析逻辑。 |
| | **日志调试** | 在代码关键流程节点添加日志输出语句，通过查看日志文件追溯程序实际执行路径和数据变化。 |
| **检测方法** | **静态检测** | 不运行程序，通过工具或人工检查代码、配置文件等静态资源，发现潜在问题（如代码审计）。 |
| | **动态检测** | 运行程序后，模拟用户操作、发送测试请求，实时监控程序运行状态和输出结果。 |
| | **压力检测** | 模拟大量用户并发访问或高负载场景（如JMeter），监控系统响应时间、CPU/内存占用率，判断性能瓶颈。 |

**面试回答：**

调试方法：断点调试、日志调试。检测方法：静态检测、动态检测、压力检测。

---

### 106. ★★★☆☆ 如何防止Frida、Xposed等注入攻击？

1. **检测Frida/Xposed注入特征：** 通过检查系统端口（如Frida默认的**27042端口**）是否被监听，或检测**内存映射**中是否存在Frida/Xposed的典型模块（如`frida-gadget.so`）。若发现匹配项则触发防御机制。
2. **运行时动态检测：** 在应用运行过程中持续监控关键行为，如敏感函数的调用频率或数据流向。例如，通过**Hook技术**检测是否有外部代码试图修改内存数据或拦截系统调用。
3. **使用安全框架与工具：** 集成专业的**安全加固方案**（如FairGuard），利用其内置的反注入模块主动识别恶意行为，通过**底层检测手段**（如内核钩子）实时拦截注入尝试。

**面试回答：**

查注入特征（端口、内存模块）、运行时动态检测（Hook技术）、用安全框架与工具（底层检测、加固方案）。

---

### 107. ★★★☆☆ 如何防止当前设备的数据拷贝到其他设备？

1. **硬件接口限制：** 通过BIOS设置或组策略**禁用USB数据传输功能**（仅保留充电），禁用OTG功能，限制HDMI、雷电接口等仅用于显示，阻断物理层面的拷贝途径。
2. **数据加密：** 对设备中的数据进行**加密处理**，例如电脑端开启全盘加密（如BitLocker），对敏感文件单独加密，即使数据被强行拷贝到其他设备，也无法正常读取。
3. **监控拦截拷贝：** 部署**终端安全管理软件（EDR/DLP）**，设置规则监控“文件拷贝到USB设备”“通过聊天软件发送大文件”等行为，触发规则时自动**拦截操作**，并向管理员发送报警信息。

**面试回答：**

硬件接口限制（禁用USB数据传输、OTG），数据加密（全盘加密、敏感文件单独加密），监控拦截拷贝（EDR/DLP）。

---

### 108. ★★★☆☆ 外挂有几种类型的实现方式？

1. **内存外挂：** 通过**读取和修改游戏运行时的内存数据**实现作弊，例如定位玩家坐标、生命值等关键数据并篡改。
2. **封包外挂：** **截取并修改客户端与服务器之间的通信数据包**，通过伪造或篡改数据实现作弊，例如修改发送到服务器的移动坐标数据，使角色瞬移。
3. **专用插件类外挂：** 针对特定游戏开发的定制化外挂，以**动态链接库**（如`SO`文件）形式**注入游戏进程**，通过**HOOK技术**（修改游戏函数调用逻辑）实现功能，例如多次触发怪物扣血函数。

**面试回答：**

内存外挂、封包外挂、专用插件类外挂。

---

### 109. ★★★★☆ 如何避免未经用户授权获取权限？

1. **系统层面设置强制授权流程：** 设备操作系统（如iOS、Android）针对敏感权限（如定位、相机、麦克风），设置**“实时弹窗请求”**机制，应用只有获得用户点击“允许”后才能获取权限，禁止通过系统漏洞、后台程序等方式绕过弹窗。
2. **技术拦截应用违规获取权限行为：** 系统内置**权限沙箱**和**隐私保护框架**，限制应用仅能访问已授权的资源，阻止应用后台调用未授权权限；对通过Root、越狱等方式试图绕过系统授权的应用，系统会立即触发**警告弹窗**，并禁止其访问敏感资源。

**面试回答：**

系统强制授权（敏感权限必须弹窗），技术拦截违规（权限沙箱、隐私保护框架）。

---

## 基础设施安全面试题目

### 110. ★★★★☆ DDoS/CC如何有效防御与应急？

| 攻击类型 | 防御措施 | 描述 |
| :--- | :--- | :--- |
| **DDoS（大流量）**| **高防IP与流量清洗** | 利用云服务商提供的**高防IP**，设置单IP请求频率阈值，自动清洗SYN包或高频HTTP请求，将合法流量转发给源站。 |
| | **CDN** | 通过CDN将静态资源缓存到边缘节点，分流源站压力，边缘节点能分担DDoS攻击。 |
| **CC（应用层）**| **Web应用防火墙（WAF）** | WAF利用规则库拦截恶意HTTP请求，针对CC攻击设置**动态验证码验证**（如JS挑战），过滤自动化脚本流量。 |

**面试回答：**

高防IP与流量清洗（清伪造包、限频）、CDN（缓存分流）、WAF（验证码验证脚本）。

---

### 111. ★★★★☆ 如何对网络区域进行划分？

1. **按功能角色划分：** 根据设备功能定位划分，例如“办公终端区”“服务器区”（Web、数据库、应用服务器）“网络设备区”，各区通过VLAN或子网划分隔离，办公终端区不能直接访问服务器区敏感端口。
2. **按安全等级划分：** 根据数据敏感度和安全防护要求划分，例如“外网区域”“DMZ区域”（面向外网的公开服务）“内网核心区”（核心数据库）“内网办公区”，各区域间用防火墙隔离，配置严格的访问控制策略。
3. **按业务系统划分：** 根据不同业务独立性划分，例如“财务业务区”“OA办公区”“生产业务区”，确保单一业务系统故障不影响其他业务。

**面试回答：**

按功能角色分、按安全等级分、按业务系统分。

---

### 112. ★★★☆☆ VPC对比经典网络的优势？

| 对比维度 | 经典网络 | VPC（虚拟私有云） |
| :--- | :--- | :--- |
| **网络隔离性** | 所有用户共享同一公网IP资源池，内网IP统一分配，**隔离性差**。 | 通过独立的**虚拟网络空间**实现二层逻辑隔离，私网IP用户自定义，**不同VPC之间默认完全隔离**，无IP冲突和跨用户攻击。 |
| **安全性** | 缺乏网络层的**集中控制**，安全防护依赖实例自身的白名单策略。 | 通过**安全组、网络ACL（访问控制列表）**和**隧道封装技术**实现多层防护，可禁止非授权IP访问核心业务子网。 |

**面试回答：**

网络隔离性（VPC独立隔离，无IP冲突），安全性（VPC用安全组、ACL多层防护，经典网络缺乏集中控制）。

---

### 113. ★★★☆☆ 主机最重要的基线是什么？

**基线：** 保障主机能安全运行的最低要求。

1. **账号与认证基线：** 要求主机设置**复杂密码**、**定期强制更换**，禁用默认账号，对重要账号启用**多因素认证**（MFA），防止账号被暴力破解。
2. **系统更新基线：** 需及时为操作系统和安装的软件组件（如浏览器、数据库）**安装安全补丁**，修复已知漏洞，卸载老旧软件。
3. **权限控制基线：** 遵循**最小权限原则**，为不同用户或进程分配刚好满足工作需求的权限，不授予多余权限，限制管理员账号的日常使用。

**面试回答：**

账号与认证基线、系统更新基线、权限控制基线。

---

### 114. ★★★★☆ 云原生下的网络和主机差异是什么？会有哪些新的风险？

| 对比维度 | 传统主机网络 | 云原生网络 |
| :--- | :--- | :--- |
| **IP地址管理** | IP地址相对**固定**，管理简单。 | 容器IP**频繁变化**，需依赖**服务发现**（CoreDNS）关联“服务名”与动态IP。 |
| **通信模型** | **主机到主机**的直接通信，路径清晰。 | **容器到容器**的跨节点通信，需通过**Overlay**（叠加网络）或**Underlay**技术封装数据包，逻辑更复杂。 |
| **新风险** | **故障定位难度提升：** 包含“容器、节点、网络插件”等多个层级，故障点可能出现在任意环节，排查难度大。 | **攻击面大幅扩大：** 一个业务由大量微服务组成，容器镜像若有漏洞，会导致攻击面扩大数倍，且易**横向扩散**。 |

**面试回答：**

差异：IP管理（传统固定，云原生动态），通信模型（传统直接，云原生多层封装）。新风险：故障定位难度提升、攻击面大幅扩大（易横向扩散）。

---

### 115. ★★☆☆☆ 如何实现反向HTTPS代理？

1. **准备域名和SSL证书：** 需拥有一个已备案的域名，并为其申请有效的SSL/TLS证书（含公钥和私钥文件），用于在代理服务器上启用HTTPS加密。
2. **安装和配置反向代理软件：** 选择支持HTTPS的反向代理工具（如**Nginx或Apache**），安装后配置其监听443端口，将客户端请求的HTTPS流量**解密后转发**到后端服务器，配置文件中需指定证书路径和后端服务器地址。
3. **验证后端服务器连接：** 若后端支持HTTPS，需在代理配置中启用HTTPS验证，确保代理服务器能正确**校验后端证书**，避免中间人攻击风险。

**面试回答：**

备域名和SSL证书、装配反向代理软件（Nginx/Apache，解密转发）、验后端连接（若后端HTTPS，需校验后端证书）。

---

### 116. ★★★☆☆ 如何通过技术手段避免非预期端口开放？

1. **制定端口准入规则：** 梳理业务所需的必要端口，形成明确的**“端口准入清单”**，清单外的所有端口默认设为“禁止开放”。
2. **使用防火墙强制拦截：** 在**主机层面**（如Linux的iptables）和**网络层面**（如网络防火墙）分别部署防火墙，配置规则仅允许准入清单内的端口接收请求，形成“主机+网络”的双重拦截屏障。
3. **实时端口扫描与监控：** 部署端口扫描工具（如nmap）和监控系统（如Zabbix），定期对服务器进行端口扫描，一旦发现未在准入清单内的端口被开放，立即**触发告警**并及时关闭。

**面试回答：**

制定端口准入规则、使用防火墙强制拦截、实时端口扫描与监控。

---

### 117. ★★★☆☆ 一个仅有一台服务器的网站，如何安全地解决登录SSH？

**（单服务器无复杂防护，需增强基础SSH安全）**

1. **更改SSH默认端口：** 修改SSH配置文件中的默认端口号（如22）为非常见端口（如2222），避**免攻击者通过默认端口扫描**服务器。
2. **配置IP白名单：** 在服务器的SSH登录IP白名单功能中**添加信任的公网IP地址**，确保只有指定IP能发起SSH连接，防止未授权的远程登录。
3. **限制SSH到Private IP：** 将SSH绑定到服务器的**私有IP地址**而非公网IP，仅允许同一私有网络内的设备通过内网访问SSH（需通过VPN连接），**避免公网暴露SSH服务**。

**面试回答：**

改SSH默认端口、配置IP白名单、限制SSH到Private IP。

---

### 118. ★★★☆☆ 容器存在哪些特有安全风险？

1. **基础镜像安全隐患：** 容器运行依赖的基础镜像（如Linux镜像）若存在**未修复的系统漏洞、预装恶意软件**，或包含多余的组件/服务，所有基于该镜像创建的容器都会继承这些风险。
2. **容器与主机内核共享风险：** 容器与宿主机**共享同一内核**，若容器内的应用程序利用内核漏洞（如权限提升漏洞）发起攻击，可直接影响宿主机系统的稳定性和安全性，甚至渗透到其他共享内核的容器。
3. **容器隔离机制不彻底风险：** 容器的隔离级别低于虚拟机，攻击者可通过**“容器逃逸”**技术突破Namespace隔离，访问宿主机的文件系统或进程；若未配置严格的网络策略，不同容器间可随意通信，导致风险易扩散。

**面试回答：**

基础镜像隐患、共享内核风险、隔离机制不彻底风险。

---

### 119. ★★★☆☆ 运维白屏化的难点是什么？

**白屏化：** 将运维工作从命令行（黑屏）转为图形化界面（GUI）操作。

1. **技术实现复杂性：** 自动化脚本和工具的开发需要覆盖多种场景，不同业务需求可能导致**脚本逻辑高度定制化**，增加调试和维护成本。
2. **多系统兼容性问题：** 企业内部可能混合使用不同厂商的硬件、操作系统或云平台（如AWS与阿里云），白屏化工具需**适配异构环境**（如Kubernetes集群与传统虚拟机管理），可能因API接口差异导致监控数据无法统一展示。

**面试回答：**

技术实现复杂性（脚本定制化），多系统兼容性问题（适配异构环境）。

---

### 120. ★★★☆☆ 不同语言对于系统CA证书的信任情况有何不同？如何让各语言信任系统CA证书？

| 语言 | 信任差异 | 解决方案 |
| :--- | :--- | :--- |
| **Java** | **不信任**操作系统的CA证书，使用**JDK自带的 `cacerts`** 密钥库。 | 需使用 `keytool` 命令**手动导入**系统CA证书到 `cacerts` 中，才让Java程序信任。 |
| **Python** | **requests库**等通常默认使用系统CA证书，但特定环境下可能验证失败。 | 可通过**设置环境变量**（如 `REQUESTS_CA_BUNDLE`）或在代码中指定证书路径，指引程序找到正确的证书文件。 |

**面试回答：**

Java不信系统CA证书，用JDK自带的`cacerts`，需用`keytool`手动导入。Python的`requests`默认信系统CA，但环境不对需设环境变量或代码指定证书路径。

---

### 121. ★★★☆☆ 简单描述有哪几种方式实现服务器禁外联，各自利弊是什么？

| 方式 | 描述 | 利（优势） | 弊（劣势） |
| :--- | :--- | :--- | :--- |
| **主机防火墙** | 在服务器本地配置防火墙规则（如 `iptables`），直接限制服务器的外联行为。 | **管控精准**（针对单台需求），**规则生效快**，不依赖外部设备。 | **维护复杂**（服务器多需逐台配置），易被**入侵者篡改规则**。 |
| **网络防火墙** | 在网络边界设备（如企业级防火墙）上配置ACL规则，对**整个网段**的外联流量进行统一拦截。 | **集中管控**（无需逐台配置），**不易被单台服务器入侵篡改**。 | **管控粒度粗**（难灵活调整单台需求），依赖网络设备性能，**流量大负载高**。 |
| **应用层代理** | 让服务器所有外联流量必须通过**专用代理服务器转发**，在代理上配置规则仅放行必需请求。 | 能对所有外联流量**进行审计**（记录日志），可**精准控制应用级别**的外联。 | 需**额外部署和维护代理服务器**，代理故障会导致所有服务器外联中断，可能成为**流量瓶颈**。 |

**面试回答：**

主机防火墙（本地配置，利精准弊维护难），网络防火墙（边界统一管控，利集中弊粒度粗），应用层代理（代理转发，利可审计弊故障影响大）。

---

### 122. ★★★☆☆ 如何实现在办公网区域无感访问国外互联网？

1. **部署透明代理服务器：** 在办公网出口路由器或网关设备上配置**透明代理服务**（如Squid），将所有对外的请求**自动转发**到代理服务器（需配置海外IP和SSL证书），用户无需修改浏览器或系统设置即可实现无感知访问。
2. **集成企业级VPN服务：** 在办公网核心交换机或网关部署企业专用的**VPN服务**（如OpenVPN或WireGuard），将所有出国方向的流量**加密后通过预设的海外出口节点转发**，用户访问国外资源时无需手动连接，流量自动通过加密隧道传输。

**面试回答：**

部署透明代理服务器（自动转发、用户无感），集成企业级VPN服务（加密转发、流量自动走隧道）。

---

## 威胁感知与响应面试题目

### 123. ★☆☆☆☆ 威胁感知可以在哪些层面进行？

1. **网络层威胁感知：** 针对网络中传输的**流量**进行监控与分析（如端口扫描、DDoS攻击），常用IDS/IPS。
2. **主机终端层威胁感知：** 聚焦于服务器、PC等终端设备的**系统状态与运行行为**（如异常进程、文件修改、未授权登录），常用EDR。
3. **数据层威胁感知：** 以核心**数据资产的流转与使用**为监控重点（如未授权的数据读取、数据异常传输），常用DLP、数据库审计。

**面试回答：**

网络层、主机终端层、数据层。

---

### 124. ★☆☆☆☆ 如何在服务器上抓取HTTPS流量进行分析？

**（获取解密“钥匙”是核心）**

1. **利用服务器本地HTTPS证书/私钥解密：** 若服务器本身提供HTTPS服务，且持有私钥，先用 `tcpdump` 抓取流量，再用 **`Wireshark` 导入服务器私钥**解密流量，还原明文。
2. **配置SSL密钥日志（SSLKEYLOGFILE）抓取：** 通过设置 **`SSLKEYLOGFILE` 环境变量**，让支持该功能的应用（如`curl`、Python `requests`）将HTTPS会话的**临时密钥**写入日志文件，`Wireshark` 加载日志文件解密。
3. **部署反向代理拦截并抓取：** 在网络链路中部署支持HTTPS解密的反向代理（如Nginx、Mitmproxy），由代理完成解密，同时**抓取代理端的明文流量**。

**面试回答：**

用服务器证书/私钥解密、配SSL密钥日志抓取、部署反向代理抓取。

---

### 125. ★★☆☆☆ 清洗流量时可以通过哪些方式降低无用流量？

1. **IP地址过滤：** 通过分析流量来源的IP地址，识别并阻止已知的**恶意IP**（如数据中心IP、代理IP或黑名单IP），避免无效流量占用带宽和服务器资源。
2. **用户行为分析：** 监控用户在网站上的操作行为（如请求频率、时间间隔、浏览路径），对不符合正常用户模式的**机器人流量**进行标记和过滤。

**面试回答：**

IP地址过滤、用户行为分析。

---

### 126. ★★☆☆☆ 清洗流量时如实现URL的去重？

1. **URL标准化处理：** 先对流量中的所有URL进行统一格式处理，消除因格式差异导致的“假重复”。操作包括**统一协议、去除锚点、参数排序、统一大小写**，让相同资源的URL呈现完全一致的字符串。
2. **基于哈希值比对去重：** 将标准化后的URL转换为**固定长度的哈希值**（如MD5、SHA-1），通过比对哈希值判断URL是否重复，**仅存储短哈希值**，适合大规模流量的高效去重。
3. **动态参数过滤去重：** 针对含动态参数的URL（如带时间戳、随机数、分页参数的URL），先**过滤无关动态参数**（如`timestamp`、`random`），再进行标准化与去重，避免因参数动态变化导致的“漏去重”。

**面试回答：**

URL标准化、哈希值比对去重、动态参数过滤去重。

---

### 127. ★★★☆☆ 清洗流量时如何剔除攻击流量？

1. **黑名单过滤：** 将已知的攻击源IP地址加入黑名单，**直接拦截**其流量。
2. **基于行为的检测：** 通过分析流量的行为模式（如**请求频率、访问路径、数据包大小**等）识别异常行为。例如，攻击流量通常表现为短时间内高频请求。
3. **流量限速：** 对单个IP或特定类型的流量设置**速率阈值**，超过限制的流量被丢弃或延迟处理，从而缓解DDoS攻击对服务器资源的消耗。

**面试回答：**

黑名单过滤、基于行为的检测、流量限速。

---

### 128. ★★★☆☆ 清洗流量时可能会导致哪些潜在的安全风险？

**最核心风险：** 正常流量被误过滤。

- 清洗规则若**过于严格或逻辑存在漏洞**，可能将合法的业务流量误判为异常流量并过滤，导致**正常用户访问受阻、业务功能中断**。例如，将某类频繁的正常API调用误判为恶意攻击流量拦截，会造成业务异常。

**面试回答：**

正常流量被误过滤，导致业务功能中断。

---

### 129. ★★★☆☆ 清洗流量时如何识别新增接口？

1. **流量监控工具检测：** 通过部署流量监控系统（如Wireshark），实时分析网络流量中的接口访问模式，当检测到**接口流量突然增加**或出现**新接口请求**时，系统会标记为异常并生成告警。
2. **协议特征比对：** 利用已知协议的特征库（如HTTP、TCP/IP）与流量中的接口通信行为进行比对，识别**不符合规范的接口**。例如，新增接口可能使用**非标准端口号**或发送**异常协议字段**。
3. **系统日志追踪：** 检查网络设备（如交换机、路由器）的系统日志，追踪接口状态变化记录。例如，当交换机的接口连接新设备时，日志中会显示MAC地址变更或**接口状态从“down”变为“up”**的事件。

**面试回答：**

流量监控工具检测、协议特征比对、系统日志追踪。

---

### 130. ★★★★☆ 如何实现近实时风险处置？

1. **搭建实时风险监测体系：** 整合多维度数据来源（如网络流量、主机状态、应用日志），借助NTA、EDR等工具，对数据进行**实时解析和初步筛选**，第一时间捕捉风险信号。
2. **配置风险自动分析与判定规则：** 通过预设规则和**AI或机器学习模型**，自动识别风险类型、等级，避免人工分析耗时。设置风险**优先级分级**（如高危、中危），确保处置资源优先投向影响最大的风险。
3. **部署自动化响应处置脚本：** 针对不同类型的风险，预先编写可直接执行的处置脚本（如**自动封禁IP**、**终止进程并隔离主机**），实现风险发现后无需人工操作即可自动处理，大幅缩短处置时间。

**面试回答：**

搭建实时风险监测体系、配置风险自动分析与判定规则、部署自动化响应处置脚本。

---

### 131. ★★☆☆☆ WireShark如何抓取非浏览器的HTTPS请求流量？

**（非浏览器应用通常不支持证书私钥解密，需靠密钥日志）**

1. **配置SSL/TLS密钥日志（最常用）：** 对于非浏览器的应用程序（如命令行工具、移动应用），需手动设置**环境变量 `SSLKEYLOGFILE`**，让应用将TLS会话的**临时密钥**写入日志文件，供Wireshark解密使用。
2. **导入服务器私钥：** 若无法获取客户端的密钥日志，可从HTTPS服务器**导出私钥文件**（如`.pem`或`.key`文件），在Wireshark中配置，该方法**仅适用于RSA密钥交换算法**。

**面试回答：**

配置SSL/TLS密钥日志（设置环境变量 `SSLKEYLOGFILE` 获取临时密钥），导入服务器私钥（只支持RSA算法）。

---

### 132. ★★☆☆☆ 端上有哪些风险特征？

1. **系统权限与应用篡改特征：** 终端获取**root（安卓）或越狱（iOS）权限**；应用被**注入恶意代码**（如插入窃取数据的代码）；应用被**重打包**（篡改官方应用后重新签名分发）。
2. **运行环境异常特征：** 应用处于**debug调试模式**；应用被**多开**（常用于恶意刷量、批量注册）；应用运行在**模拟器或虚拟容器**中（非真实物理设备环境，可规避设备绑定安全策略）。

**面试回答：**

系统权限与应用篡改特征（root/越狱、代码注入、重打包），运行环境异常特征（debug模式、被多开、跑在模拟器中）。

---

### 133. ★★☆☆☆ 常见的C&C通道种类和特征？

**C&C通道：** 黑客远程操控被感染设备的隐蔽通信管道。

| 通道种类 | 核心特征 |
| :--- | :--- |
| **基于HTTP/HTTPS**| **伪装正常流量**：请求和响应与普通网页访问类似，内容可能被加密。**长连接维持**（HTTP长轮询/WebSocket）。流量特征：**上行流量（上传数据）远大于下行流量**。 |
| **DNS隧道** | **隐蔽性最强**：所有通信都封装在**DNS数据包**中，防火墙通常不拦截DNS流量。数据拆分成**多个小包**（每个DNS查询最多携带255字节）。异常域名解析：频繁查询**“无意义域名”**。 |

**面试回答：**

基于HTTP/HTTPS的通道（伪装正常流量、长连接维持），DNS隧道通道（隐蔽性最强、所有通信封装在DNS数据包中）。

---

### 134. ★★★☆☆ 如何在加密流量中检测出恶意流量？

1. **基于元数据的黑白名单与异常检测：** 分析加密流量可见的**元数据**（如源IP、目的IP、端口、连接时间），命中恶意IP/域名的**黑名单**则判定为恶意；监控元数据的异常，比如加密流量频繁使用**非标准端口**、短时间内从同一IP发起**大量加密连接**。
2. **分析加密流量的行为特征模式：** 统计加密流量的**连接频率、时长、数据包大小、交互节奏**，对比正常流量的行为基线。例如，恶意软件的加密流量可能有固定的**“心跳包”模式**（如每隔10秒发送一个小数据包）、连接时长极短。
3. **验证SSL/TLS证书的合法性：** 检查证书是否**过期、被吊销**；核查证书颁发机构（CA）是否为正规机构，**自签名证书**用于公网场景大概率是恶意流量；核查证书的“主题”与实际访问的域名是否匹配。

**面试回答：**

基于元数据的黑白名单与异常检测、分析加密流量的行为特征模式、验证SSL/TLS证书的合法性。

---

### 135. ★★★☆☆ 基于网络五元组可以做到哪些风险行为的分析？

**网络五元组：** 源IP、目的IP、源端口、目的端口、传输层协议。

1. **识别异常流量：** 通过分析五元组中IP的交互频率、端口组合及协议类型，发现不符合业务需求的流量。例如，某内部服务器突然频繁向外部IP的非标准端口发送TCP流量，可能表明被**植入后门程序**。
2. **检测非法访问：** 利用五元组规则限制特定IP或端口的访问权限。例如，某数据库仅允许内网IP通过3306端口访问，若检测到来自公网IP的相同端口请求，则可能涉及**未授权的数据库探针攻击**。
3. **追踪数据泄露路径：** 通过监控五元组中的源IP与目的IP组合，结合传输协议（如HTTPS）判断是否存在敏感数据外传。例如，某员工电脑在非工作时间通过HTTPS协议向陌生域名发送大量数据包，可能暗示**数据通过加密通道泄露**。

**面试回答：**

识别异常流量、检测非法访问、追踪数据泄露路径。

---

### 136. ★★☆☆☆ 抽象来看主机中有哪些后门实现方式？

1. **系统服务后门：** 通过修改或创建系统服务加载恶意代码，例如利用 `svchost.exe` 进程组运行恶意 DLL 文件，使恶意代码随系统启动自动运行，并**隐藏在正常服务进程中**。
2. **计划任务后门：** 利用操作系统的任务计划功能**定时执行恶意命令或脚本**（如 `schtasks`、`crontab`），实现**长期驻留**并绕过部分安全软件的实时监控。
3. **文件上传后门：** 通过 Web 服务**上传恶意文件**（如PHP或ASP脚本）作为后门入口，例如将**一句话木马**嵌入图片或 HTML 文件，利用服务器配置缺陷实现远程控制。

**面试回答：**

系统服务后门、计划任务后门、文件上传后门。

---

### 137. ★★★☆☆ 一个黑客入侵主机后植入了—个木马，并擦除了各种日志，如何找出其如何入侵的以及入侵后做了什么事？

1. **找未清完的日志残留：** 查主机**日志备份**（如Linux的`/var/log`旧日志、Windows存档日志）、**网络设备**（如防火墙、路由器）或**集中日志系统**（如ELK）的日志，能还原入侵记录。
2. **查系统配置和文件异常：** 看账号（如`/etc/passwd`）有无新增/权限变的账号；对比关键配置文件（如防火墙规则）看有无异常；用工具查系统文件是否被改，找**新增陌生文件**（如木马）。
3. **提取木马样本分析：** **静态分析**（用IDA Pro等）看代码、找控制端IP等；隔离环境**动态分析**，看木马创建文件、发网络请求等行为；传木马哈希到**威胁情报平台**查同源报告，反推入侵路径。

**面试回答：**

找未清完的日志残留、查系统配置和文件异常、提取木马样本分析。

---

### 138. ★★★★☆ 某个黑客入侵主机后，拿到了root权限，如何止血？

1. **断开网络连接：** 立即将受感染的主机**从网络中隔离**（拔网线/禁用网卡），防止黑客通过root权限进一步窃取数据或**横向渗透**其他系统，同时避免恶意代码自动上传敏感信息。
2. **清除后门与恶意文件：** 扫描系统中隐藏的后门程序（如 `/tmp`、`/dev/shm` 等临时目录），删除未授权的计划任务、服务及配置文件，清理上传的Webshell或恶意脚本。
3. **修补漏洞与更新补丁：** 检查操作系统及软件版本，**修复已知漏洞**（如未更新的Apache），禁用不必要的服务，安装最新安全补丁。

**面试回答：**

断开网络连接、清除后门与恶意文件、修补漏洞与更新补丁。

---

### 139. ★★★★★ 感知到黑客入侵了服务器，怎么办？

1. **立即隔离受影响服务器的网络：** **第一时间断开所有被入侵服务器的内外网连接**（如拔网线、在网络设备上禁用服务器端口），避免黑客通过已入侵服务器**横向渗透**到其他系统，或持续窃取数据。**避免直接重启服务器**（可能导致内存中恶意进程、临时数据丢失，影响后续取证）。
2. **全面评估风险影响范围：** 快速排查所有服务器的入侵程度，明确黑客已实施的操作及潜在威胁。检查所有服务器的**账号系统**（删除未授权新增账号，修改所有合法管理员密码）；查看**进程列表**（终止陌生、路径异常的恶意进程，记录进程ID）；核查服务器的**核心文件**（判断是否有文件被篡改、删除或复制的痕迹，尤其关注敏感数据泄露迹象）；检查服务器的**端口开放状态**（关闭非业务必需的端口）。

**面试回答：**

马上隔离服务器网络、全面评估风险影响范围（查账号、查进程、查文件、查端口）。

---

### 140. ★☆☆☆☆ 如何准确识别域名探测？

1. **分析域名请求频率节奏：** 看同一来源单位时间内请求数和间隔，**短时间高频**（如几秒内发几十次请求），或**间隔固定**（如每秒1次），远超正常用户（1分钟1-2次），可能是域名探测。
2. **识别异常域名格式：** 查域名结构，含大量`admin`、`test`等**未用子域名**，或带**随机字符串**，且未备案，或用`.info`等小众后缀，可能是探测。
3. **核查请求来源：** 看来源是否在合法白名单里，**陌生IP**、**恶意IP**，或同一IP请求**多个无关域名**，境外IP无业务需求的，可能是探测。

**面试回答：**

分析域名请求频率节奏、识别异常域名格式、核查请求来源。

---

### 141. ★☆☆☆☆ 如何准确识别端口探测？

1. **分析网络流量：** 盯流量，看同一IP**快速连接多个端口**，比如防火墙测到大量**没有完成握手的SYN包**，可能是在扫端口。
2. **查系统日志：** 看服务器日志（如Linux的`/var/log/auth.log`），短时间内同一IP连接**非标准端口**、扫描**多个端口**，就是异常。
3. **部署IDS（入侵检测系统）：** 用Snort等IDS工具，设好规则（如**短时间扫描超过50个端口**），自动告警并记录攻击IP和目标端口。

**面试回答：**

分析网络流量（看SYN包、快速连多端口）、查系统日志（看短时间连非标准端口）、部署IDS。

---

### 142. ★★☆☆☆ 如何准确识别文件遍历探测？

1. **用专业工具检测：** 装SearchMyFiles、FileSeek或用Linux的`find`命令，**扫文件系统记访问痕迹**，看文件打开、修改时间、路径和操作者，找异常遍历。
2. **分析系统日志：** 查Windows事件查看器、Linux的`/var/log/`，看**频繁读取文件**、**非正常时间访问**、**高频遍历目录**，比如短时间读大量隐藏/加密文件，可能是探测。
3. **监控文件访问：** 用进程监视器等工具**实时追踪访问动态**，程序**递归访问多目录**、读非目标文件或绕权限，可能是遍历探测，设警报规则定位可疑操作。

**面试回答：**

用专业工具检测（记访问痕迹）、分析系统日志（查频繁读文件、非正常时间访问）、监控文件访问（实时追踪访问动态）。

---

### 143. ★★☆☆☆ SQL注入拦截规则如何实现？

1. **特征码匹配规则：** 基于已知SQL注入攻击的常见模式（如包含单引号、分号、关键字`UNION`、`DROP`等），通过**正则表达式或黑名单机制**匹配用户输入中的异常字符，例如检测到请求参数中包含`' OR '1'='1`时直接拦截。
2. **输入验证与过滤规则：** 对用户输入的数据进行**严格格式校验**，例如邮箱字段只允许字母、数字和`@`符号；或通过**白名单机制**仅接受预设范围内的值（如数字、日期格式），从源头减少恶意代码注入的可能性。
3. **最小权限原则配置：** 为数据库账户分配**最低必要权限**（如仅允许查询特定表或禁止执行`DROP`命令），即使攻击者成功注入SQL代码，也无法对数据库造成严重破坏。

**面试回答：**

特征码匹配规则、输入验证与过滤规则、最小权限原则配置。

---

### 144. ★★★☆☆ 如何实现页面篡改感知？

1. **建立页面基准信息库：** 提前采集并存储正常页面的核心特征，**计算页面文件（如HTML、CSS、JS文件）的哈希值**（如MD5、SHA256），记录哈希值与对应文件的关联关系。
2. **基于哈希值的实时比对：** 通过实时或定时计算当前页面文件的哈希值，与基准信息库中的哈希值对比，**若不一致，立即标记为“疑似篡改”并触发告警**，适合静态页面。
3. **监控页面文件的访问与修改行为：** 从文件操作源头入手，**监控服务器上页面文件的修改、删除、新增操作**，记录操作账号、操作时间、操作类型（如Linux的auditd），发现未授权账号或异常进程操作，立即告警阻止篡改。

**面试回答：**

建页面基准库（算哈希值），哈希实时比对，监控文件操作。

---

### 145. ★★★☆☆ 如何实现页面挂马感知？

**页面挂马：** 攻击者在网页中植入恶意代码或链接，使用户访问时自动下载或执行恶意程序。

1. **基于特征码的恶意代码检测：** 利用正则表达式或黑名单规则匹配网页源代码中的可疑字符（如**iframe嵌套**、**异常脚本链接**、`eval`函数调用等），例如检测到包含恶意网站的iframe标签时触发告警。
2. **行为分析与访问日志审查：** 通过分析服务器日志中的**异常跳转路径**（如大量请求被重定向到第三方域名）、用户代理异常等，识别潜在挂马行为。
3. **自动化扫描工具部署：** 使用如360网站安全检测、腾讯云WAF等工具，通过**模拟浏览器渲染页面**、解析HTML结构及**对比文件哈希值**，自动识别隐藏的恶意代码或文件篡改痕迹。

**面试回答：**

特征码检测恶意代码、行为分析与日志审查、部署自动化扫描工具。

---

### 146. ★★★☆☆ 如何识别公共和私有接口？

| 类别 | 公共接口（Public Interface） | 私有接口（Private Interface） |
| :--- | :--- | :--- |
| **文档与公开范围** | 通常在**官方文档中明确标注**其功能、调用方式及访问权限（如Google Maps API）。 | 文档可能**仅限于内部团队使用**，甚至未对外公开（如公司内部管理系统接口）。 |
| **访问权限标识**| 在代码或配置文件中，常通过 `public`、`export` 等关键字或配置项声明。 | 通过 `private`、`internal` 等修饰符**限制访问**，仅能被系统内部调用。 |
| **使用场景与调用方** | 设计用于**外部开发者或第三方服务调用**（如支付平台提供的API）。 | 服务于**系统内部模块间的通信**（如库存管理模块与订单处理模块之间的数据交互）。 |

**面试回答：**

文档与公开范围、访问权限标识、使用场景与调用方。

---

### 147. ★★★★☆ 如何识别机器行为请求？

1. **分析请求频率与时间间隔：** 机器请求通常具有**固定频率或均匀时间间隔**（如1分钟50次、间隔精确到1秒），且可能**24小时不间断**；而人类请求间隔随机、频率有波动。
2. **验证请求头与设备信息的合理性：** 机器请求的请求头（如User-Agent）常存在**异常**（如`Python-urllib/3.8`），或**设备标识**（如设备ID、浏览器指纹）**重复、不完整**；而人类使用的设备信息更完整且具有唯一性。
3. **核查IP与网络环境的异常特征：** 机器行为常使用**代理IP、虚拟IP**，或**同一IP关联大量账号/设备**，且**多个IP的请求轨迹完全一致**；而人类多使用固定IP，同一IP关联的账号数量有限。

**面试回答：**

分析请求频率与时间间隔、验证请求头与设备信息的合理性、核查IP与网络环境的异常特征。

---

### 148. ★★★★☆ 如何感知越权风险？

1. **自动化工具检测：** 利用如AIFuzzing、VulHunter等工具，通过代理捕获真实流量并自动**移除鉴权信息**（如Cookie、Token）后重放请求，检测接口是否缺乏访问控制（垂直越权）。
2. **日志与行为分析：** 通过分析服务器日志中的**异常访问模式**（如低权限用户频繁访问高权限接口、同一IP短时间内尝试访问多个用户资源），结合用户操作上下文判断是否存在越权尝试。
3. **人工渗透测试：** 模拟攻击者操作，例如使用Burp Suite**替换不同用户的身份凭证**（Cookie或Token）调用相同接口，观察响应是否返回越权数据（水平越权）。

**面试回答：**

自动化工具检测（移除鉴权信息重放请求）、日志与行为分析（异常访问模式）、人工渗透测试（替换身份凭证）。

---

### 149. ★★★★☆ 如何识别攻击请求是定点攻击还是随机扫描？

| 对比维度 | 定点攻击（Targeted Attack） | 随机扫描（Random Scan） |
| :--- | :--- | :--- |
| **攻击目标范围** | **高度集中：** 仅针对1个或少数几个**核心价值资产**（如Web服务器、数据库服务器），不会同时攻击无关目标。 | **范围极广：** 针对多个**无关联的IP、域名或端口**（如扫描某一IP段内的所有80/443端口），目标无核心价值倾向。 |
| **攻击手段针对性**| **强针对性：** 攻击手段精准匹配目标特征（如已知目标使用Log4j漏洞的Java框架，就专门发送Log4j攻击payload）。 | **通用性：** 使用适用于多数系统的通用漏洞或payload（如通用SQL注入语句、弱密码字典爆破），**不依赖目标的具体特征**。 |

**面试回答：**

攻击目标范围与集中度、攻击手段针对性。

---

### 150. ★★★★☆ 有哪些类型应用层风险是无法在流量层较好感知的？

**（流量层只看格式和协议，不理解业务逻辑和数据语义）**

1. **业务逻辑越权访问：** 攻击者通过修改请求中的“用户ID”参数，访问其他用户的订单详情，该请求在流量层**格式合法、协议正常**，但流量层**缺乏应用内部的权限判断规则**，无法感知请求的权限合法性。
2. **数据语义层面的恶意篡改：** 攻击者修改请求中的关键数据参数（如金额从“100元”改为“1元”），修改后的参数在流量层表现为**合法格式**，但流量层**无法理解参数的业务含义**（如“金额是否在合理范围”），需依赖应用层业务规则才能识别。
3. **合法请求的恶意序列组合：** 攻击者将多个单独合法的请求（如注册、登录、下单），按特定顺序组合发起，形成恶意业务行为（如批量刷量），流量层因**无法关联多个请求的行为序列**，仅能判断单个请求合法，无法识别序列的恶意性。

**面试回答：**

业务逻辑越权访问、数据语义层面的恶意篡改、合法请求的恶意序列组合。

---

### 151. ★★★★★ 如何识别客户端的系统真实类型？

1. **用户代理字符串解析（UA）：** 客户端在HTTP请求中携带**User-Agent**字符串，服务器可通过解析UA的关键词（如`Windows NT 10.0`、`Macintosh`）识别系统类型，但需注意部分UA可能被篡改。
2. **设备指纹生成：** 收集客户端硬件和软件特征（如**屏幕分辨率、时区、字体列表、GPU信息**等），通过算法生成唯一指纹，与已知系统特征库比对，判断其真实操作系统类型。
3. **多维度交叉验证：** 将UA解析结果与**JavaScript检测**（如`navigator.platform`）、设备指纹、网络行为等数据**交叉比对**。例如，若UA声称是Windows系统，但JavaScript检测是Linux，则需进一步检查是否存在**UA伪装**或客户端实际运行在**虚拟机**中。

**面试回答：**

用户代理字符串解析、设备指纹生成、多维度交叉验证。

---

### 152. ★★☆☆☆ 各种常见木马的优劣势？

| 木马类型 | 优势 | 劣势 |
| :--- | :--- | :--- |
| **远程控制型**| **功能全面**（查看屏幕、操作文件、开摄像头），适合长期控制目标资产，隐蔽性较强。 | **体积较大**，占用资源，易被进程监控发现，连接特征明显易被拦。 |
| **下载型** | **传播效率高**，体积极小（常仅几KB），无需攻击者手动操作，适合批量感染大量主机。 | **无独立攻击功能**，下载地址被封或目标断网就失效，刚植入就外联下载易被查杀。 |
| **反弹连接型**| 能**绕过目标主机的防火墙限制**（主机主动向外连接），连接方式灵活，不易被防火墙按“异常端口”拦截。 | **高度依赖网络环境**（目标需能访问控制端IP），控制端需要持续在线，异常外联可能被检测。 |

**面试回答：**

远程控制型木马、下载型木马、反弹连接型木马的优劣势。

---

### 153. ★★★☆☆ 木马免杀有哪些方式？

**免杀：** 逃避杀毒软件检测的技术。

1. **代码混淆与变种：** 通过修改代码逻辑（如调整指令顺序、添加无用代码或加密关键部分），使恶意程序的**特征与已知病毒样本差异较大**，能有效规避基于静态分析的杀毒软件。
2. **进程注入与内存加载：** 将恶意代码**注入到合法进程中**（如`explorer.exe`）或**直接在内存中运行**，避免生成可被扫描的本地文件，绕过杀毒软件的静态查杀。
3. **多层混合免杀：** 结合多种技术（如**加壳 + 代码混淆 + 内存加载**），形成多层防护，同时绕过静态扫描、内存查杀和行为监控。

**面试回答：**

代码混淆与变种、进程注入与内存加载、多层混合免杀。

---

### 154. ★★★☆☆ 木马隧道有哪些？哪种隧道在当前最有效？

| 隧道类型 | 特点 |
| :--- | :--- |
| **DNS隧道** | 利用DNS协议传输木马数据，**隐蔽性高**（DNS流量通常不被严格拦截），但**速度慢**，且频繁查询陌生域名容易被发现。 |
| **SSH隧道** | 利用SSH协议建立加密隧道，**安全性高**，但端口（默认22）**容易被防火墙限制**，且网络限制较多。 |
| **HTTPS隧道**| **当前最有效**。HTTPS是主流协议，防火墙默认放行，**SSL/TLS加密**可防止内容被解析，隐蔽性强、速度快、兼容性好。 |

**面试回答：**

DNS隧道（隐蔽但慢）、SSH隧道（安全但易被限端口）、当前最有效是HTTPS隧道（防火墙默认放行、加密强）。

---

### 155. ★★★☆☆ 有哪些有效的钓鱼方式？

1. **邮件钓鱼：** 伪装成银行、电商平台、公司行政等官方机构，发送标题带有“账户异常”“订单失效”等**紧急字样的邮件**，邮件内附带**虚假登录链接或附件**，诱导受害者点击。
2. **仿冒网站钓鱼：** 克隆官方网站的外观，只修改网址中的**个别字符**（如`taobao`改为`taobaoo`），通过邮件、短信等方式引导受害者进入该虚假网站，截获用户数据。
3. **社交工程钓鱼：** 在社交平台（如微信、QQ）上**伪装成受害者的熟人、同事或客户**，以“急需用钱周转”“帮忙代付订单”等理由，诱导受害者**转账**，或点击含有恶意链接的文件。

**面试回答：**

邮件钓鱼、仿冒网站钓鱼、社交工程钓鱼。

---

### 156. ★★☆☆☆ 如何绕过WAF？

1. **字符编码绕过：** 攻击者对请求中的恶意字符（如SQL注入的单引号、XSS的`<>`标签）进行**特殊编码**（如URL编码、Unicode编码），WAF若未全面解码和检测，会被规避，而后端Web服务器会自动解码执行。
2. **利用解析差异绕过：** WAF与后端Web服务器对HTTP请求的解析规则可能存在差异（如WAF忽略路径中的特殊符号），攻击者构造**符合后端解析规则但不符合WAF检测规则**的请求。
3. **白名单IP绕过：** 部分WAF会配置IP白名单，对来自白名单内的IP（如企业内部管理IP）的请求直接放行，攻击者通过**代理、VPN、肉鸡**等方式，获取并使用白名单内的IP地址发送恶意请求。

**面试回答：**

字符编码绕过、利用解析差异绕过、白名单IP绕过。

---

### 157. ★★☆☆☆ 如何绕过HIDS？

**HIDS（主机入侵检测系统）：** 监控主机内部行为。

1. **内存驻留：** 通过**“无文件攻击”**手段（如内存注入），让恶意代码直接在内存中运行，**不生成可被扫描的文件**，也不留下完整的进程日志，从而规避HIDS的文件扫描和进程行为分析。
2. **代码混淆与动态生成：** 对恶意代码进行**代码混淆**（如Base64编码）或**动态生成**（在运行时临时组装恶意命令），破坏恶意代码的静态特征，躲过HIDS的特征码匹配。
3. **合法进程伪装：** 利用**进程注入、DLL劫持**等技术，将恶意代码注入到**系统信任的合法进程**（如`svchost.exe`、`explorer.exe`）中，让恶意操作以“合法进程的身份”执行，规避HIDS的检测。

**面试回答：**

内存驻留（无文件攻击）、代码混淆与动态生成、合法进程伪装。

---

### 158. ★★☆☆☆ BadUSB原理及局限？

| 类别 | 描述 |
| :--- | :--- |
| **原理** | **固件篡改与伪装机制：** 对USB设备固件重新编程，使设备插入电脑时被识别为**键盘**等受信任的**HID设备**。 **滥用HID协议的信任：** 计算机系统默认信任HID设备的输入，BadUSB利用这一特性，在用户无感知的情况下**自动输入指令**（如打开运行窗口、下载木马）。 |
| **局限** | **设备兼容性与技术门槛：** 部分USB设备（如加密U盘）有**硬件加密或写保护**机制，防止固件被篡改；攻击者需要掌握特定的**硬件开发知识**。 |

**面试回答：**

原理是固件篡改伪装成HID设备，滥用HID协议信任自动输入指令。局限是设备有硬件加密保护，且攻击技术门槛高。

---

### 159. ★★☆☆☆ 如何在禁止出网的机器上访问互联网？

1. **内网穿透：** 通过**公网服务器**作为中转，在禁止出网的机器与公网服务器之间建立**加密隧道**（如使用FRP、Ngrok等工具），将本地请求转发到互联网，实现**间接访问**。
2. **代理转发：** 在禁止出网的机器上配置代理服务器（如Socks5代理），将请求通过**允许出网的中间设备**（如公司内部的跳板机）转发到互联网。

**面试回答：**

内网穿透（公网服务器当中转，建加密隧道）、代理转发（借能出网的中间设备）。

---

### 160. ★★☆☆☆ ew、frp差异？

| 对比维度 | ew（Earthworm） | frp（Fast Reverse Proxy） |
| :--- | :--- | :--- |
| **核心定位** | **渗透测试**的**网络穿透工具**（Socks5代理、端口转发）。 | **企业级内网穿透解决方案**（内网服务暴露到公网）。 |
| **协议支持** | **仅Socks5**。 | **多协议**（TCP、UDP、HTTP、HTTPS、STCP等）。 |
| **部署方式** | **单文件二进制程序**，无需配置文件，适合**临时渗透场景**。 | **需部署服务端和客户端**，依赖配置文件，支持高并发，适合**长期稳定服务**。 |

**面试回答：**

ew主要建网络隧道（Socks5代理），适合灵活穿透和临时渗透场景；frp专注内网穿透（多协议），支持高并发，适合远程管理和企业服务公网暴露。

---

### 161. ★★☆☆☆ 如何进行水坑攻击？

**水坑攻击：** 在目标群体高频访问的合法网站中植入恶意代码，实现定向攻击。

1. **信息收集：** 确定目标群体的**常用网站**（如行业论坛、内部OA系统），并选择安全防护较弱的中小型网站作为突破口。
2. **分析并渗透目标网站：** 寻找漏洞注入恶意代码，例如扫描其使用的软件（如CMS系统、插件）是否存在**已知漏洞**，或通过社会工程学诱骗管理员点击恶意链接。
3. **部署恶意代码：** 植入隐蔽的恶意代码，例如通过修改网页的JavaScript代码，利用浏览器漏洞自动下载木马，或在页面中嵌入**伪装成合法更新**的下载链接。

**面试回答：**

信息收集（确定目标常上的网站）、分析并渗透目标网站（找漏洞插恶意代码）、部署恶意代码（藏好恶意代码诱用户触发）。

---

### 162. ★★☆☆☆ 如何利用XSS让影响最大化？

1. **植入高流量公共平台：** 将XSS代码注入访问量巨大的公共平台（如热门论坛的帖子、电商网站的商品评价区），一旦XSS代码被植入并成功执行，所有打开该页面的用户都会触发攻击，攻击者可**批量窃取这些用户的Cookie**、账号密码等信息。
2. **利用管理员身份触发攻击：** 针对网站后台、管理系统等**具备高权限的页面**植入XSS代码，当管理员登录后台并打开含有XSS代码的页面时，代码会在管理员的权限环境下执行，攻击者可**冒充管理员登录后台**，进而执行删除网站数据、篡改页面内容、导出用户数据库等操作。
3. **结合社会工程学诱导扩散：** 在XSS代码中加入**诱导性逻辑**，让被攻击用户**主动帮助扩散攻击**（如自动发送含有恶意链接的消息），使攻击影响范围以几何倍数扩大。

**面试回答：**

植入高流量公共平台、利用管理员身份触发攻击、结合社会工程学诱导扩散。

---

## 安全开发面试题目

### 163. ★★★☆☆ 利用HTTPS交互过程中的特性，如何实现让常见抓包工具无法抓某个站点？

1. **SSL/TLS证书锁定（Pinning）：** 客户端（APP/浏览器插件）在代码里预先写入目标服务器的**专属证书指纹或公钥**，通信时强制校验。即使抓包工具伪造证书，客户端也会因“身份证不匹配”直接拒绝连接，让抓包工具无法拦截数据。
2. **应用层二次加密：** 客户端和服务器约定一套**自定义加密规则**（如AES对称加密），对传输的“关键数据”（如账号密码、转账金额）先加密，再放进HTTPS的“加密快递箱”里。即使抓包工具破解了HTTPS的“外层锁”，看到的也是被“二次加密”的乱码。
3. **强制HTTPS严格传输（HSTS）：** 服务器在HTTP响应头里添加HSTS策略（`Strict-Transport-Security`），强制浏览器在一段时间内**拒绝HTTP请求**和**接受无效证书**，彻底阻断用户因疏忽绕过证书校验的可能，抓包工具无法通过伪造证书拦截。

**面试回答：**

SSL/TLS证书锁定、应用层二次加密、强制HTTPS严格传输（HSTS）。

---

### 164. ★★★☆☆ OAuth2.0交互过程及其中可能存在的配置不当安全风险？

| 类别 | 描述 | 配置不当风险 |
| :--- | :--- | :--- |
| **交互过程** | 1. **第三方应用发起授权请求：** 携带客户端ID、权限范围（scope）、重定向URI。 2. **资源所有者确认授权：** 用户登录，同意授权。 3. **授权服务器返回授权码：** 生成临时授权码，通过重定向URI返回给第三方应用。 4. **第三方应用兑换访问令牌：** 携带授权码、客户端ID和**客户端密钥**向令牌端点申请令牌。 5. **第三方应用访问资源：** 携带访问令牌向资源服务器请求资源。 | 1. **重定向URI未严格校验：** 攻击者可构造恶意URI，窃取授权码。 2. **授权码未限制使用次数或泄露：** 授权码可重复兑换令牌；传输授权码时未使用HTTPS，被攻击者拦截。 3. **客户端密钥泄露：** 密钥以明文形式存储或通过前端传输，攻击者可盗用密钥冒充合法应用。 |

**面试回答：**

交互过程（请求授权、用户确认、返回授权码、兑换令牌、访问资源）。风险（重定向URI未严格校验、授权码未限制使用次数或泄露）。

---

### 165. ★★☆☆☆ 获取一个入参url，请求url地址的内容时应注意什么？

**（当请求外部不可信URL时，核心防范SSRF和本地攻击）**

1. **输入验证与安全性防护：** 在接收URL参数时，需严格校验其合法性，**禁止包含特殊字符**（如`#`、`%`）或**非法路径**（如`../../etc/passwd`），防止路径遍历攻击或SSRF攻击。应通过**白名单机制**验证URL格式和域名。
2. **SSRF防护：** **禁用不必要的协议**（如`file://`、`gopher://`），**限制访问内网IP**（如127.0.0.1、192.168.x.x），确保服务器不会被诱导访问本地资源或内网服务。
3. **加密协议与证书信任链：** 若目标URL使用HTTPS协议，需确保客户端支持**TLS 1.2及以上版本**，并**验证服务器证书的有效性**（是否过期、是否为可信CA），防止中间人攻击。

**面试回答：**

输入验证（白名单、禁特殊字符），SSRF防护（禁不必要协议、限访问内网IP），加密与证书（TLS 1.2+，验证证书有效性）。

---

### 166. ★★☆☆☆ 参数入库前应该如何过滤？

1. **按数据库字段类型校验参数类型：** 根据参数对应的数据库字段类型（如`int`、`varchar`、`datetime`），检查传入参数的**类型是否匹配**（如年龄必须是纯数字），避免因类型不匹配导致入库失败，或被利用构造恶意SQL语句。
2. **验证数据长度与格式合法性：** 按照数据库字段的**长度限制**（如`varchar(50)`）和**业务格式要求**（如手机号、邮箱的固定格式），对参数进行检查，避免数据溢出或不符合存储规则。
3. **采用白名单机制限定允许的内容：** 优先使用**白名单规则**，明确规定参数中**仅允许出现的字符、格式或值范围**（如性别只允许“男”“女”），不在白名单内的内容直接过滤，从源头限制非法数据。

**面试回答：**

按数据库字段类型校验参数类型、验证数据长度和格式合法性、采用白名单机制限定允许的内容。

---

### 167. ★★☆☆☆ 过滤器和拦截器原理和应用场景？

| 对比维度 | 过滤器（Filter） | 拦截器（Interceptor） |
| :--- | :--- | :--- |
| **原理** | Servlet容器提供，实现 `javax.servlet.Filter` 接口。在**请求到达Servlet之前**进行预处理，通过 `FilterChain` 链式调用。 | Spring MVC框架提供，实现 `HandlerInterceptor` 接口。在**控制器方法执行前后**进行增强处理，能访问Spring上下文。 |
| **处理范围** | **所有HTTP请求**（包括静态资源、Servlet）。 | 仅**Spring MVC的控制器方法**。 |
| **应用场景** | **通用处理：** 字符编码统一、安全过滤（SQL注入/XSS）、请求日志记录。 | **业务增强：** 登录验证、权限控制、参数校验、事务管理。 |

**面试回答：**

原理（过滤器是Servlet容器提供，拦截器是Spring MVC框架提供），处理范围（过滤器是所有HTTP请求，拦截器是控制器方法），应用场景（过滤器是通用处理，拦截器是业务增强）。

---

### 168. ★★☆☆☆ SESSION 和 Cookie的区别？

| 对比维度 | Cookie | SESSION |
| :--- | :--- | :--- |
| **存储位置** | **客户端**（浏览器本地），用户可查看、修改、删除。 | **服务器端**（内存/数据库/文件），用户无法直接接触原始数据。 |
| **安全性** | **较低**（易被窃取/篡改）。 | **较高**（数据在服务器，用户仅通过Session ID关联）。 |
| **数据大小限制**| **严格限制**（通常4KB以内）。 | **无严格限制**（取决于服务器存储资源）。 |
| **生命周期** | 可设置长期或会话级。 | 默认会话级（关浏览器/超时删除）。 |

**面试回答：**

存储位置（Cookie客户端，Session服务器端），安全性（Cookie低，Session高），数据大小（Cookie限4KB，Session无严格限制）。

---

### 169. ★☆☆☆☆ SESSION ID如何不被Javascript读取？

**（核心是防范XSS攻击窃取Session ID）**

1. **设置Cookie的HttpOnly属性：** 在服务器端设置Cookie时，为SESSION ID的Cookie添加 **`HttpOnly` 标志**。该标志会阻止JavaScript通过 `document.cookie` 或任何API访问该Cookie，从而防止恶意脚本窃取会话信息。
2. **避免在URL中传递SESSION ID：** SESSION ID不应通过URL参数（如`?sessionid=abc123`）传递，因为URL可能被浏览器历史记录、日志文件或第三方工具泄露。
3. **使用HTTPS加密通信：** 在传输SESSION ID时，必须启用HTTPS协议。HTTPS通过加密数据防止中间人攻击（MITM），同时在Cookie中设置 **`Secure` 标志**，确保Cookie仅通过加密连接发送。

**面试回答：**

设置Cookie的`HttpOnly`属性、避免在URL中传递SESSION ID、使用HTTPS加密通信。

---